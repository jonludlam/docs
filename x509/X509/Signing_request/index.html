<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Signing_request (x509.X509.Signing_request)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> – <a href="../../index.html">x509</a> &#x00BB; <a href="../index.html">X509</a> &#x00BB; Signing_request</nav><header><h1>Module <code>X509.Signing_request</code></h1><p>A certificate authority (CA) deals with <a href="https://tools.ietf.org/html/rfc2986">PKCS 10 certificate signing requests</a>, their construction and encoding, and provisioning using a private key to generate a certificate with a signature thereof.</p></header><nav class="toc"><ul><li><a href="#decoding-and-encoding-in-asn.1-der-and-pem-format">Decoding and encoding in ASN.1 DER and PEM format</a></li><li><a href="#construction-of-a-signing-request">Construction of a signing request</a></li><li><a href="#provision-a-signing-request-to-a-certificate">Provision a signing request to a certificate</a></li></ul></nav><div class="content"><div><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></div><div><p>The abstract type of a (self-signed) certification request.</p></div></div><h2 id="decoding-and-encoding-in-asn.1-der-and-pem-format"><a href="#decoding-and-encoding-in-asn.1-der-and-pem-format" class="anchor"></a>Decoding and encoding in ASN.1 DER and PEM format</h2><div><div class="spec value" id="val-decode_der" class="anchored"><a href="#val-decode_der" class="anchor"></a><code><span class="keyword">val</span> decode_der : <span>?&#8288;hash_whitelist:<span><a href="../../../mirage-crypto/Mirage_crypto/Hash/index.html#type-hash">Mirage_crypto.Hash.hash</a> list</span></span> <span>&#45;&gt;</span> <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <span>[&gt; <a href="../../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a> ]</span>)</span> <a href="../../../rresult/Rresult/index.html#type-result">Rresult.result</a></span></code></div><div><p><code>decode_der ~hash_whitelist cstruct</code> is <code>signing_request</code>, the ASN.1 decoded <code>cstruct</code> or an error. The signature on the signing request is validated, and its hash algorithm must be in <code>hash_whitelist</code> (by default only SHA-2 is accepted).</p></div></div><div><div class="spec value" id="val-encode_der" class="anchored"><a href="#val-encode_der" class="anchor"></a><code><span class="keyword">val</span> encode_der : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></div><div><p><code>encode_der sr</code> is <code>cstruct</code>, the ASN.1 encoded representation of the <code>sr</code>.</p></div></div><div><div class="spec value" id="val-decode_pem" class="anchored"><a href="#val-decode_pem" class="anchor"></a><code><span class="keyword">val</span> decode_pem : <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <span>[&gt; <a href="../../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a> ]</span>)</span> <a href="../../../rresult/Rresult/index.html#type-result">Rresult.result</a></span></code></div><div><p><code>decode_pem pem</code> is <code>t</code>, where the single signing request of the <code>pem</code> is extracted</p></div></div><div><div class="spec value" id="val-encode_pem" class="anchored"><a href="#val-encode_pem" class="anchor"></a><code><span class="keyword">val</span> encode_pem : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></div><div><p><code>encode_pem signing_request</code> is <code>pem</code>, the pem encoded signing request.</p></div></div><h2 id="construction-of-a-signing-request"><a href="#construction-of-a-signing-request" class="anchor"></a>Construction of a signing request</h2><div class="spec module" id="module-Ext" class="anchored"><a href="#module-Ext" class="anchor"></a><code><span class="keyword">module</span> <a href="Ext/index.html">Ext</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><div class="spec type" id="type-request_info" class="anchored"><a href="#type-request_info" class="anchor"></a><code><span class="keyword">type</span> request_info = {</code><table><tr id="type-request_info.subject" class="anchored"><td class="def record field"><a href="#type-request_info.subject" class="anchor"></a><code>subject : <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a>;</code></td></tr><tr id="type-request_info.public_key" class="anchored"><td class="def record field"><a href="#type-request_info.public_key" class="anchor"></a><code>public_key : <a href="../Public_key/index.html#type-t">Public_key.t</a>;</code></td></tr><tr id="type-request_info.extensions" class="anchored"><td class="def record field"><a href="#type-request_info.extensions" class="anchor"></a><code>extensions : <a href="Ext/index.html#type-t">Ext.t</a>;</code></td></tr></table><code>}</code></div><div><p>The raw request info of a <a href="https://tools.ietf.org/html/rfc2986#section-4">PKCS 10 certification request info</a>.</p></div></div><div><div class="spec value" id="val-info" class="anchored"><a href="#val-info" class="anchor"></a><code><span class="keyword">val</span> info : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-request_info">request_info</a></code></div><div><p><code>info signing_request</code> is <a href="index.html#type-request_info"><code>request_info</code></a>, the information inside the <code>signing_request</code>.</p></div></div><div><div class="spec value" id="val-signature_algorithm" class="anchored"><a href="#val-signature_algorithm" class="anchor"></a><code><span class="keyword">val</span> signature_algorithm : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(<span>[ `RSA <span>| `ECDSA</span> ]</span> * <a href="../../../mirage-crypto/Mirage_crypto/Hash/index.html#type-hash">Mirage_crypto.Hash.hash</a>)</span> option</span></code></div><div><p><code>signature_algorithm signing_request</code> is the algorithm used for the signature.</p></div></div><div><div class="spec value" id="val-hostnames" class="anchored"><a href="#val-hostnames" class="anchor"></a><code><span class="keyword">val</span> hostnames : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Host/Set/index.html#type-t">Host.Set.t</a></code></div><div><p><code>hostnames signing_request</code> is the set of domain names this <code>signing_request</code> is requesting. This is either the content of the DNS entries of the SubjectAlternativeName extension, or the common name of the <code>signing_request</code>.</p></div></div><div><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a> <span>&#45;&gt;</span> <span>?&#8288;digest:<a href="../../../mirage-crypto/Mirage_crypto/Hash/index.html#type-hash">Mirage_crypto.Hash.hash</a></span> <span>&#45;&gt;</span> <span>?&#8288;extensions:<a href="Ext/index.html#type-t">Ext.t</a></span> <span>&#45;&gt;</span> <a href="../Private_key/index.html#type-t">Private_key.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></div><div><p><code>create subject ~digest ~extensions private</code> creates <code>signing_request</code>, a certification request using the given <code>subject</code>, <code>digest</code> (defaults to <code>`SHA256</code>) and list of <code>extensions</code>.</p></div></div><h2 id="provision-a-signing-request-to-a-certificate"><a href="#provision-a-signing-request-to-a-certificate" class="anchor"></a>Provision a signing request to a certificate</h2><div><div class="spec value" id="val-sign" class="anchored"><a href="#val-sign" class="anchor"></a><code><span class="keyword">val</span> sign : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>valid_from:<a href="../../../ptime/Ptime/index.html#type-t">Ptime.t</a></span> <span>&#45;&gt;</span> <span>valid_until:<a href="../../../ptime/Ptime/index.html#type-t">Ptime.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;hash_whitelist:<span><a href="../../../mirage-crypto/Mirage_crypto/Hash/index.html#type-hash">Mirage_crypto.Hash.hash</a> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;digest:<a href="../../../mirage-crypto/Mirage_crypto/Hash/index.html#type-hash">Mirage_crypto.Hash.hash</a></span> <span>&#45;&gt;</span> <span>?&#8288;serial:<a href="../../../zarith/Z/index.html#type-t">Z.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;extensions:<a href="../Extension/index.html#type-t">Extension.t</a></span> <span>&#45;&gt;</span> <a href="../Private_key/index.html#type-t">Private_key.t</a> <span>&#45;&gt;</span> <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Certificate/index.html#type-t">Certificate.t</a>, <span>[&gt; <a href="../Validation/index.html#type-signature_error">Validation.signature_error</a> ]</span>)</span> <a href="../../../rresult/Rresult/index.html#type-result">Rresult.result</a></span></code></div><div><p><code>sign signing_request ~valid_from ~valid_until ~hash_whitelist ~digest ~serial ~extensions private issuer</code> creates <code>certificate</code>, a signed certificate. Signing can fail if the signature on the <code>signing_request</code> is invalid, or its hash algorithm does not occur in <code>hash_whitelist</code> (default all SHA-2 algorithms). Public key and subject are taken from the <code>signing_request</code>, the <code>extensions</code> are added to the X.509 certificate. The <code>private</code> key is used to sign the certificate, the <code>issuer</code> is recorded in the certificate. The digest defaults to <code>`SHA256</code>. The <code>serial</code> defaults to a random value between 1 and 2^64. Certificate version is always 3. Please note that the extensions in the <code>signing_request</code> are ignored, you can pass them using:</p><pre><code>match Ext.find Extensions (info csr).extensions with
| Ok ext -&gt; ext
| Error _ -&gt; Extension.empty</code></pre></div></div></div></body></html>