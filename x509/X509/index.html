<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>X509 (x509.X509)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">x509</a> &#x00BB; X509</nav><header><h1>Module <code>X509</code></h1><p>X509 encoding, generation, and validation.</p><p><code>X509</code> is a module for handling X.509 certificates and supplementary material (such as public and private RSA keys), as described in <a href="https://tools.ietf.org/html/rfc5280">RFC 5280</a>. X.509 describes a hierarchical public key infrastructure, where all trust is delegated to certificate authorities (CA). The task of a CA is to sign certificate signing requests (CSR), which turns them into certificates, after verification that the requestor is eligible.</p><p>An X.509 certificate is an authentication token: a public key, a subject (e.g. server name), a validity period, optionally a purpose (usage), and various other optional <span class="xref-unresolved">Extensions</span>.</p><p>The public keys of trusted CAs are distributed with the software, or configured manually. When an endpoint connects, it presents its certificate chain, which are pairwise signed certificates. This chain is verified: the signatures have to be valid, the last certificate must be signed by a trusted CA, the name has to match the expected name, all certificates must be valid at the current time, and the purpose of each certificate must match its usage. An alternative validator checks that the hash of the server certificate matches the given hash.</p><p>This module uses the <code>result</code> type for errors. No provided binging raises an exception. Provided submodules include decoders and encoders (ASN.1 DER and PEM encoding) of X.509v3 <span class="xref-unresolved">certificates</span>, <span class="xref-unresolved">distinguished names</span>, <span class="xref-unresolved">public keys</span> and <span class="xref-unresolved">private keys</span> (<a href="http://tools.ietf.org/html/rfc5208">PKCS 8, RFC 5208</a>), and <span class="xref-unresolved">certificate signing requests</span> (<a href="http://tools.ietf.org/html/rfc2986">PKCS 10, RFC 2986</a>, both use parts of <a href="https://tools.ietf.org/html/rfc2985">PKCS 9, RFC 2985</a>), <span class="xref-unresolved">certificate validation</span> by construction of <span class="xref-unresolved">authenticators</span>. Name validation, as defined in <a href="https://tools.ietf.org/html/rfc6125">RFC 6125</a>, is also implemented.</p><p>Missing is the handling of online certificate status protocol. Some X.509v3 extensions are not handled, but only parsed, such as name constraints. If any extension is marked as critical in a certificate, but not handled, the validation will fail. The only supported key type is RSA.</p><p><em>v0.11.2 - <a href="https://github.com/mirleft/ocaml-x509">homepage</a></em></p></header><div class="content"><div class="spec module" id="module-Host" class="anchored"><a href="#module-Host" class="anchor"></a><code><span class="keyword">module</span> <a href="Host/index.html">Host</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><div class="spec module" id="module-Public_key" class="anchored"><a href="#module-Public_key" class="anchor"></a><code><span class="keyword">module</span> <a href="Public_key/index.html">Public_key</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>RSA public key DER and PEM encoding and decoding</p></div></div><div><div class="spec module" id="module-Private_key" class="anchored"><a href="#module-Private_key" class="anchor"></a><code><span class="keyword">module</span> <a href="Private_key/index.html">Private_key</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>RSA private key pem encoding and decoding</p></div></div><div><div class="spec module" id="module-Distinguished_name" class="anchored"><a href="#module-Distinguished_name" class="anchor"></a><code><span class="keyword">module</span> <a href="Distinguished_name/index.html">Distinguished_name</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>X.500 distinguished name</p></div></div><div><div class="spec module" id="module-General_name" class="anchored"><a href="#module-General_name" class="anchor"></a><code><span class="keyword">module</span> <a href="General_name/index.html">General_name</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>A list of <code>general_name</code>s is the value of both <a href="https://tools.ietf.org/html/rfc5280#section-4.2.1.6">subjectAltName</a> and <a href="https://tools.ietf.org/html/rfc5280#section-4.2.1.7">IssuerAltName</a> extension.</p></div></div><div><div class="spec module" id="module-Extension" class="anchored"><a href="#module-Extension" class="anchor"></a><code><span class="keyword">module</span> <a href="Extension/index.html">Extension</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>X.509v3 extensions</p></div></div><div><div class="spec module" id="module-Certificate" class="anchored"><a href="#module-Certificate" class="anchor"></a><code><span class="keyword">module</span> <a href="Certificate/index.html">Certificate</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>X509v3 certificate</p></div></div><div><div class="spec module" id="module-Validation" class="anchored"><a href="#module-Validation" class="anchor"></a><code><span class="keyword">module</span> <a href="Validation/index.html">Validation</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>Chain Validation.</p></div></div><aside><p>Certificate Signing request</p></aside><div><div class="spec module" id="module-Signing_request" class="anchored"><a href="#module-Signing_request" class="anchor"></a><code><span class="keyword">module</span> <a href="Signing_request/index.html">Signing_request</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>A certificate authority (CA) deals with <a href="https://tools.ietf.org/html/rfc2986">PKCS 10 certificate signing requests</a>, their construction and encoding, and provisioning using a private key to generate a certificate with a signature thereof.</p></div></div><div><div class="spec module" id="module-CRL" class="anchored"><a href="#module-CRL" class="anchor"></a><code><span class="keyword">module</span> <a href="CRL/index.html">CRL</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>X.509 Certificate Revocation Lists.</p></div></div><div><div class="spec module" id="module-Authenticator" class="anchored"><a href="#module-Authenticator" class="anchor"></a><code><span class="keyword">module</span> <a href="Authenticator/index.html">Authenticator</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>Certificate chain authenticators</p></div></div></div></body></html>