<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Arp_packet (arp.Arp_packet)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> – <a href="../index.html">arp</a> &#x00BB; Arp_packet</nav><header><h1>Module <code>Arp_packet</code></h1><p>Conversion between wire and high-level data</p><p>The <span class="xref-unresolved">high-level datatype</span> can be decoded and encoded to bytes to be sent on the wire. ARP specifies hardware and protocol addresses, but this implementation picks Ethernet and IPv4 statically. While decoding can result in an error, encoding can not.</p></header><nav class="toc"><ul><li><a href="#decoding">Decoding</a></li><li><a href="#encoding">Encoding</a></li></ul></nav><div class="content"><div class="spec type" id="type-op" class="anchored"><a href="#type-op" class="anchor"></a><code><span class="keyword">type</span> op = </code><table><tr id="type-op.Request" class="anchored"><td class="def variant constructor"><a href="#type-op.Request" class="anchor"></a><code>| <span class="constructor">Request</span></code></td></tr><tr id="type-op.Reply" class="anchored"><td class="def variant constructor"><a href="#type-op.Reply" class="anchor"></a><code>| <span class="constructor">Reply</span></code></td></tr></table></div><div class="spec value" id="val-op_to_int" class="anchored"><a href="#val-op_to_int" class="anchor"></a><code><span class="keyword">val</span> op_to_int : <a href="index.html#type-op">op</a> <span>&#45;&gt;</span> int</code></div><div class="spec value" id="val-int_to_op" class="anchored"><a href="#val-int_to_op" class="anchor"></a><code><span class="keyword">val</span> int_to_op : int <span>&#45;&gt;</span> <span><a href="index.html#type-op">op</a> option</span></code></div><div><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t = {</code><table><tr id="type-t.operation" class="anchored"><td class="def record field"><a href="#type-t.operation" class="anchor"></a><code>operation : <a href="index.html#type-op">op</a>;</code></td></tr><tr id="type-t.source_mac" class="anchored"><td class="def record field"><a href="#type-t.source_mac" class="anchor"></a><code>source_mac : <a href="../../macaddr/Macaddr/index.html#type-t">Macaddr.t</a>;</code></td></tr><tr id="type-t.source_ip" class="anchored"><td class="def record field"><a href="#type-t.source_ip" class="anchor"></a><code>source_ip : <a href="../../ipaddr/Ipaddr/V4/index.html#type-t">Ipaddr.V4.t</a>;</code></td></tr><tr id="type-t.target_mac" class="anchored"><td class="def record field"><a href="#type-t.target_mac" class="anchor"></a><code>target_mac : <a href="../../macaddr/Macaddr/index.html#type-t">Macaddr.t</a>;</code></td></tr><tr id="type-t.target_ip" class="anchored"><td class="def record field"><a href="#type-t.target_ip" class="anchor"></a><code>target_ip : <a href="../../ipaddr/Ipaddr/V4/index.html#type-t">Ipaddr.V4.t</a>;</code></td></tr></table><code>}</code></div><div><p>The high-level ARP frame consisting of the two address pairs and an operation.</p></div></div><div><div class="spec value" id="val-size" class="anchored"><a href="#val-size" class="anchor"></a><code><span class="keyword">val</span> size : int</code></div><div><p><code>size</code> is the size of an ARP frame.</p></div></div><div><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></div><div><p><code>pp ppf t</code> prints the frame <code>t</code> on <code>ppf</code>.</p></div></div><div><div class="spec value" id="val-equal" class="anchored"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></div><div><p><code>equal a b</code> returns <code>true</code> if frames <code>a</code> and <code>b</code> are equal, <code>false</code> otherwise.</p></div></div><div><div class="spec type" id="type-error" class="anchored"><a href="#type-error" class="anchor"></a><code><span class="keyword">type</span> error = </code><table><tr id="type-error.Too_short" class="anchored"><td class="def variant constructor"><a href="#type-error.Too_short" class="anchor"></a><code>| <span class="constructor">Too_short</span></code></td></tr><tr id="type-error.Unusable" class="anchored"><td class="def variant constructor"><a href="#type-error.Unusable" class="anchor"></a><code>| <span class="constructor">Unusable</span></code></td></tr><tr id="type-error.Unknown_operation" class="anchored"><td class="def variant constructor"><a href="#type-error.Unknown_operation" class="anchor"></a><code>| <span class="constructor">Unknown_operation</span> <span class="keyword">of</span> <a href="../../cstruct/Cstruct/index.html#type-uint16">Cstruct.uint16</a></code></td></tr></table></div><div><p>The type of possible errors during decoding</p><ul><li><code>Too_short</code> if the provided buffer is not long enough</li><li><code>Unusable</code> if the protocol or hardware address type is not IPv4 and Ethernet</li><li><code>Unknown_operation</code> if it is neither a request nor a reply</li></ul></div></div><div><div class="spec value" id="val-pp_error" class="anchored"><a href="#val-pp_error" class="anchor"></a><code><span class="keyword">val</span> pp_error : <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-error">error</a> <span>&#45;&gt;</span> unit</code></div><div><p><code>pp_error ppf err</code> prints the error <code>err</code> on <code>ppf</code>.</p></div></div><h3 id="decoding"><a href="#decoding" class="anchor"></a>Decoding</h3><div><div class="spec value" id="val-decode" class="anchored"><a href="#val-decode" class="anchor"></a><code><span class="keyword">val</span> decode : <a href="../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <a href="index.html#type-error">error</a>)</span> <a href="../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></span></code></div><div><p><code>decode buf</code> attempts to decode the buffer into an ARP frame <code>t</code>.</p></div></div><h3 id="encoding"><a href="#encoding" class="anchor"></a>Encoding</h3><div><div class="spec value" id="val-encode" class="anchored"><a href="#val-encode" class="anchor"></a><code><span class="keyword">val</span> encode : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></div><div><p><code>encode t</code> is a <code>buf</code>, a freshly allocated buffer, which contains the encoded ARP frame <code>t</code>.</p></div></div><div><div class="spec value" id="val-encode_into" class="anchored"><a href="#val-encode_into" class="anchor"></a><code><span class="keyword">val</span> encode_into : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> <span>&#45;&gt;</span> unit</code></div><div><p><code>encode_into t buf</code> encodes <code>t</code> into the buffer <code>buf</code> at offset 0.</p><dl><dt>raises Invalid_argument</dt><dd><p>if the buffer <code>buf</code> is too small (below 28 bytes).</p></dd></dl></div></div></div></body></html>