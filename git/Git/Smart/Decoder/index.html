<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Decoder (git.Git.Smart.Decoder)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">git</a> &#x00BB; <a href="../../index.html">Git</a> &#x00BB; <a href="../index.html">Smart</a> &#x00BB; Decoder</nav><header><h1>Module <code>Smart.Decoder</code></h1><aside><p>The <i>functor</i> to make the Decoder by a specific hash implementation.</p></aside><h3 id="parameters"><a href="#parameters" class="anchor"></a>Parameters</h3><div class="spec parameter" id="argument-1-Hash" class="anchored"><a href="#argument-1-Hash" class="anchor"></a><code><span class="keyword">module</span> <a href="argument-1-Hash/index.html">Hash</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec parameter" id="argument-2-Reference" class="anchored"><a href="#argument-2-Reference" class="anchor"></a><code><span class="keyword">module</span> <a href="argument-2-Reference/index.html">Reference</a> : <a href="../../Reference/module-type-S/index.html">Reference.S</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="../../Reference/module-type-S/Hash/index.html">Hash</a> := <a href="argument-1-Hash/index.html">Hash</a></code></div><div class="spec parameter" id="argument-3-Common" class="anchored"><a href="#argument-3-Common" class="anchor"></a><code><span class="keyword">module</span> <a href="argument-3-Common/index.html">Common</a> : <a href="../module-type-COMMON/index.html">COMMON</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../module-type-COMMON/index.html#type-hash">hash</a> := <a href="argument-1-Hash/index.html#type-t">Hash.t</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="../module-type-COMMON/index.html#type-reference">reference</a> := <a href="argument-2-Reference/index.html#type-t">Reference.t</a></code></div><h3 id="signature"><a href="#signature" class="anchor"></a>Signature</h3></header><div class="content"><div><div class="spec type" id="type-decoder" class="anchored"><a href="#type-decoder" class="anchor"></a><code><span class="keyword">type</span> decoder</code></div><div><p>The type decoder.</p></div></div><div><div class="spec value" id="val-pp_decoder" class="anchored"><a href="#val-pp_decoder" class="anchor"></a><code><span class="keyword">val</span> pp_decoder : <span><a href="index.html#type-decoder">decoder</a> <a href="../../../../fmt/Fmt/index.html#type-t">Fmt.t</a></span></code></div><div><p>Pretty-printer of <a href="index.html#val-decoder"><code>decoder</code></a>.</p></div></div><div class="spec value" id="val-extract_payload" class="anchored"><a href="#val-extract_payload" class="anchor"></a><code><span class="keyword">val</span> extract_payload : <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></div><div><div class="spec type" id="type-error" class="anchored"><a href="#type-error" class="anchor"></a><code><span class="keyword">type</span> error = [ </code><table><tr id="type-error.Expected_char" class="anchored"><td class="def constructor"><a href="#type-error.Expected_char" class="anchor"></a><code>| </code><code>`Expected_char <span class="keyword">of</span> char</code></td><td class="doc"><p>Appears when we encountered an other character than what we expected stricly.</p></td></tr><tr id="type-error.Unexpected_char" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_char" class="anchor"></a><code>| </code><code>`Unexpected_char <span class="keyword">of</span> char</code></td><td class="doc"><p>Appears when we encountered a character and we don't know what we can do with this.</p></td></tr><tr id="type-error.Unexpected_flush_pkt_line" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_flush_pkt_line" class="anchor"></a><code>| </code><code>`Unexpected_flush_pkt_line</code></td><td class="doc"><p>Appears when we encountered a flush packet and we don't expect this.</p></td></tr><tr id="type-error.No_assert_predicate" class="anchored"><td class="def constructor"><a href="#type-error.No_assert_predicate" class="anchor"></a><code>| </code><code>`No_assert_predicate <span class="keyword">of</span> char <span>&#45;&gt;</span> bool</code></td><td class="doc"><p>Appears when one character does not respect the predicate.</p></td></tr><tr id="type-error.Expected_string" class="anchored"><td class="def constructor"><a href="#type-error.Expected_string" class="anchor"></a><code>| </code><code>`Expected_string <span class="keyword">of</span> string</code></td><td class="doc"><p>Appears when we don't have strictly the string expected.</p></td></tr><tr id="type-error.Unexpected_empty_pkt_line" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_empty_pkt_line" class="anchor"></a><code>| </code><code>`Unexpected_empty_pkt_line</code></td><td class="doc"><p>Appears when we encountered an empty packet and we don't expect this.</p></td></tr><tr id="type-error.Malformed_pkt_line" class="anchored"><td class="def constructor"><a href="#type-error.Malformed_pkt_line" class="anchor"></a><code>| </code><code>`Malformed_pkt_line</code></td><td class="doc"><p>Appears when we encountered a flow which does not respect the packet format.</p></td></tr><tr id="type-error.Unexpected_end_of_input" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_end_of_input" class="anchor"></a><code>| </code><code>`Unexpected_end_of_input</code></td></tr><tr id="type-error.Unexpected_pkt_line" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_pkt_line" class="anchor"></a><code>| </code><code>`Unexpected_pkt_line</code></td></tr><tr id="type-error.Unexpected_hashes" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_hashes" class="anchor"></a><code>| </code><code>`Unexpected_hashes <span class="keyword">of</span> <a href="argument-1-Hash/index.html#type-t">Hash.t</a> * <a href="argument-1-Hash/index.html#type-t">Hash.t</a></code></td></tr></table><code> ]</code></div><div><p>The type error.</p></div></div><div><div class="spec value" id="val-pp_error" class="anchored"><a href="#val-pp_error" class="anchor"></a><code><span class="keyword">val</span> pp_error : <span><a href="index.html#type-error">error</a> <a href="../../../../fmt/Fmt/index.html#type-t">Fmt.t</a></span></code></div><div><p>Pretty-printer of <a href="index.html#type-error"><code>error</code></a>.</p></div></div><div class="spec type" id="type-state" class="anchored"><a href="#type-state" class="anchor"></a><code><span class="keyword">type</span> <span>'a state</span> = </code><table><tr id="type-state.Ok" class="anchored"><td class="def variant constructor"><a href="#type-state.Ok" class="anchor"></a><code>| <span class="constructor">Ok</span> <span class="keyword">of</span> <span class="type-var">'a</span></code></td><td class="doc"><p>The end value of the decoding.</p></td></tr><tr id="type-state.Read" class="anchored"><td class="def variant constructor"><a href="#type-state.Read" class="anchor"></a><code>| <span class="constructor">Read</span> <span class="keyword">of</span> {</code><table><tr id="type-state.buffer" class="anchored"><td class="def record field"><a href="#type-state.buffer" class="anchor"></a><code>buffer : <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a>;</code></td></tr><tr id="type-state.off" class="anchored"><td class="def record field"><a href="#type-state.off" class="anchor"></a><code>off : int;</code></td></tr><tr id="type-state.len" class="anchored"><td class="def record field"><a href="#type-state.len" class="anchor"></a><code>len : int;</code></td></tr><tr id="type-state.continue" class="anchored"><td class="def record field"><a href="#type-state.continue" class="anchor"></a><code>continue : int <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span>;</code></td></tr></table><code>}</code></td><td class="doc"><p>Means that we expect an input. We provide an <a href="../../../../cstruct/Cstruct/index.html#type-t"><code>Cstruct.t</code></a> with an offset and a length. The client is able to <a href="../../../../cstruct/Cstruct/index.html#val-blit"><code>Cstruct.blit</code></a> the input in this range. Then, he can call <code>continue</code> with how many byte(s) he read.</p></td></tr><tr id="type-state.Error" class="anchored"><td class="def variant constructor"><a href="#type-state.Error" class="anchor"></a><code>| <span class="constructor">Error</span> <span class="keyword">of</span> {</code><table><tr id="type-state.err" class="anchored"><td class="def record field"><a href="#type-state.err" class="anchor"></a><code>err : <a href="index.html#type-error">error</a>;</code></td></tr><tr id="type-state.buf" class="anchored"><td class="def record field"><a href="#type-state.buf" class="anchor"></a><code>buf : <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a>;</code></td></tr><tr id="type-state.committed" class="anchored"><td class="def record field"><a href="#type-state.committed" class="anchor"></a><code>committed : int;</code></td></tr></table><code>}</code></td><td class="doc"><p>When we retrieve an error, we return this value with how many byte(s) we processed and the current input.</p></td></tr></table></div><div><div class="spec type" id="type-transaction" class="anchored"><a href="#type-transaction" class="anchor"></a><code><span class="keyword">type</span> <span>_ transaction</span> = </code><table><tr id="type-transaction.HttpReferenceDiscovery" class="anchored"><td class="def variant constructor"><a href="#type-transaction.HttpReferenceDiscovery" class="anchor"></a><code>| <span class="constructor">HttpReferenceDiscovery</span> : string <span>&#45;&gt;</span> <span><span><span>(<a href="argument-3-Common/index.html#type-advertised_refs">Common.advertised_refs</a>,Â <span>[ <span>`Msg of string</span> ]</span>)</span> <a href="../../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></span> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.ReferenceDiscovery" class="anchored"><td class="def variant constructor"><a href="#type-transaction.ReferenceDiscovery" class="anchor"></a><code>| <span class="constructor">ReferenceDiscovery</span> : <span><span><span>(<a href="argument-3-Common/index.html#type-advertised_refs">Common.advertised_refs</a>,Â <span>[ <span>`Msg of string</span> ]</span>)</span> <a href="../../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></span> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.ShallowUpdate" class="anchored"><td class="def variant constructor"><a href="#type-transaction.ShallowUpdate" class="anchor"></a><code>| <span class="constructor">ShallowUpdate</span> : <span><a href="argument-3-Common/index.html#type-shallow_update">Common.shallow_update</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.Negociation" class="anchored"><td class="def variant constructor"><a href="#type-transaction.Negociation" class="anchor"></a><code>| <span class="constructor">Negociation</span> : <a href="argument-1-Hash/Set/index.html#type-t">Hash.Set.t</a> * <a href="index.html#type-ack_mode">ack_mode</a> <span>&#45;&gt;</span> <span><a href="argument-3-Common/index.html#type-acks">Common.acks</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.NegociationResult" class="anchored"><td class="def variant constructor"><a href="#type-transaction.NegociationResult" class="anchor"></a><code>| <span class="constructor">NegociationResult</span> : <span><a href="argument-3-Common/index.html#type-negociation_result">Common.negociation_result</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.PACK" class="anchored"><td class="def variant constructor"><a href="#type-transaction.PACK" class="anchor"></a><code>| <span class="constructor">PACK</span> : <a href="index.html#type-side_band">side_band</a> <span>&#45;&gt;</span> <span><a href="index.html#type-flow">flow</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.ReportStatus" class="anchored"><td class="def variant constructor"><a href="#type-transaction.ReportStatus" class="anchor"></a><code>| <span class="constructor">ReportStatus</span> : <span>string list</span> * <a href="index.html#type-side_band">side_band</a> <span>&#45;&gt;</span> <span><a href="argument-3-Common/index.html#type-report_status">Common.report_status</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.HttpReportStatus" class="anchored"><td class="def variant constructor"><a href="#type-transaction.HttpReportStatus" class="anchor"></a><code>| <span class="constructor">HttpReportStatus</span> : <span>string list</span> * <a href="index.html#type-side_band">side_band</a> <span>&#45;&gt;</span> <span><a href="argument-3-Common/index.html#type-report_status">Common.report_status</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.Upload_request" class="anchored"><td class="def variant constructor"><a href="#type-transaction.Upload_request" class="anchor"></a><code>| <span class="constructor">Upload_request</span> : <span><a href="argument-3-Common/index.html#type-upload_request">Common.upload_request</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.Git_proto_request" class="anchored"><td class="def variant constructor"><a href="#type-transaction.Git_proto_request" class="anchor"></a><code>| <span class="constructor">Git_proto_request</span> : <span><a href="argument-3-Common/index.html#type-git_proto_request">Common.git_proto_request</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.Update_request" class="anchored"><td class="def variant constructor"><a href="#type-transaction.Update_request" class="anchor"></a><code>| <span class="constructor">Update_request</span> : <span><a href="argument-3-Common/index.html#type-update_request">Common.update_request</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr></table></div><div><p>The type transaction to describe what is expected to decode/receive.</p></div></div><div><div class="spec type" id="type-ack_mode" class="anchored"><a href="#type-ack_mode" class="anchor"></a><code><span class="keyword">and</span> ack_mode = [ </code><table><tr id="type-ack_mode.Ack" class="anchored"><td class="def constructor"><a href="#type-ack_mode.Ack" class="anchor"></a><code>| </code><code>`Ack</code></td></tr><tr id="type-ack_mode.Multi_ack" class="anchored"><td class="def constructor"><a href="#type-ack_mode.Multi_ack" class="anchor"></a><code>| </code><code>`Multi_ack</code></td></tr><tr id="type-ack_mode.Multi_ack_detailed" class="anchored"><td class="def constructor"><a href="#type-ack_mode.Multi_ack_detailed" class="anchor"></a><code>| </code><code>`Multi_ack_detailed</code></td></tr></table><code> ]</code></div><div><p>The ACK mode type to describe which mode is shared by the client and the server.</p></div></div><div><div class="spec type" id="type-flow" class="anchored"><a href="#type-flow" class="anchor"></a><code><span class="keyword">and</span> flow = [ </code><table><tr id="type-flow.Raw" class="anchored"><td class="def constructor"><a href="#type-flow.Raw" class="anchor"></a><code>| </code><code>`Raw <span class="keyword">of</span> <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></td></tr><tr id="type-flow.End" class="anchored"><td class="def constructor"><a href="#type-flow.End" class="anchor"></a><code>| </code><code>`End</code></td></tr><tr id="type-flow.Err" class="anchored"><td class="def constructor"><a href="#type-flow.Err" class="anchor"></a><code>| </code><code>`Err <span class="keyword">of</span> <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></td></tr><tr id="type-flow.Out" class="anchored"><td class="def constructor"><a href="#type-flow.Out" class="anchor"></a><code>| </code><code>`Out <span class="keyword">of</span> <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></td></tr></table><code> ]</code></div><div><p>The representation of the output side-band.</p></div></div><div><div class="spec type" id="type-side_band" class="anchored"><a href="#type-side_band" class="anchor"></a><code><span class="keyword">and</span> side_band = [ </code><table><tr id="type-side_band.Side_band" class="anchored"><td class="def constructor"><a href="#type-side_band.Side_band" class="anchor"></a><code>| </code><code>`Side_band</code></td></tr><tr id="type-side_band.Side_band_64k" class="anchored"><td class="def constructor"><a href="#type-side_band.Side_band_64k" class="anchor"></a><code>| </code><code>`Side_band_64k</code></td></tr><tr id="type-side_band.No_multiplexe" class="anchored"><td class="def constructor"><a href="#type-side_band.No_multiplexe" class="anchor"></a><code>| </code><code>`No_multiplexe</code></td></tr></table><code> ]</code></div><div><p>The side-band mode type to describe which mode is shared by the client and the server.</p></div></div><div><div class="spec value" id="val-decode" class="anchored"><a href="#val-decode" class="anchor"></a><code><span class="keyword">val</span> decode : <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span><span class="type-var">'result</span> <a href="index.html#type-transaction">transaction</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'result</span> <a href="index.html#type-state">state</a></span></code></div><div><p><code>decode decoder transaction</code> decodes the input represented by <code>decoder</code> in the way of the <code>transaction</code> and returns the value expected and described by <code>transaction</code> or an error.</p></div></div><div><div class="spec value" id="val-decoder" class="anchored"><a href="#val-decoder" class="anchor"></a><code><span class="keyword">val</span> decoder : unit <span>&#45;&gt;</span> <a href="index.html#type-decoder">decoder</a></code></div><div><p><code>decoder ()</code> makes a new decoder.</p></div></div><div class="spec value" id="val-of_string" class="anchored"><a href="#val-of_string" class="anchor"></a><code><span class="keyword">val</span> of_string : string <span>&#45;&gt;</span> <span><span class="type-var">'v</span> <a href="index.html#type-transaction">transaction</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'v</span>,Â <a href="index.html#type-error">error</a> * <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> * int)</span> <a href="../../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></span></code></div></div></body></html>