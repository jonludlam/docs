<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Client (git.Git.Smart.Client)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">git</a> &#x00BB; <a href="../../index.html">Git</a> &#x00BB; <a href="../index.html">Smart</a> &#x00BB; Client</nav><header><h1>Module <code>Smart.Client</code></h1><aside><p>The <i>functor</i> to make the Client by a specific hash implementation.</p></aside><h3 id="parameters"><a href="#parameters" class="anchor"></a>Parameters</h3><div class="spec parameter" id="argument-1-Hash" class="anchored"><a href="#argument-1-Hash" class="anchor"></a><code><span class="keyword">module</span> <a href="argument-1-Hash/index.html">Hash</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec parameter" id="argument-2-Reference" class="anchored"><a href="#argument-2-Reference" class="anchor"></a><code><span class="keyword">module</span> <a href="argument-2-Reference/index.html">Reference</a> : <a href="../../Reference/module-type-S/index.html">Reference.S</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="../../Reference/module-type-S/Hash/index.html">Hash</a> := <a href="argument-1-Hash/index.html">Hash</a></code></div><h3 id="signature"><a href="#signature" class="anchor"></a>Signature</h3></header><div class="content"><div class="spec module" id="module-Common" class="anchored"><a href="#module-Common" class="anchor"></a><code><span class="keyword">module</span> <a href="Common/index.html">Common</a> : <a href="../module-type-COMMON/index.html">COMMON</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../module-type-COMMON/index.html#type-hash">hash</a> := <a href="argument-1-Hash/index.html#type-t">Hash.t</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="../module-type-COMMON/index.html#type-reference">reference</a> := <a href="argument-2-Reference/index.html#type-t">Reference.t</a></code></div><div><div class="spec module" id="module-Decoder" class="anchored"><a href="#module-Decoder" class="anchor"></a><code><span class="keyword">module</span> <a href="Decoder/index.html">Decoder</a> : <a href="../module-type-DECODER/index.html">DECODER</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="../module-type-DECODER/Hash/index.html">Hash</a> := <a href="argument-1-Hash/index.html">Hash</a> <span class="keyword">and</span> <span class="keyword">module</span> <a href="../module-type-DECODER/Reference/index.html">Reference</a> := <a href="argument-2-Reference/index.html">Reference</a> <span class="keyword">and</span> <span class="keyword">module</span> <a href="../module-type-DECODER/Common/index.html">Common</a> := <a href="Common/index.html">Common</a></code></div><div><p>The <a href="Decoder/index.html"><code>Decoder</code></a> module constrained by the same <code>Hash</code> module.</p></div></div><div><div class="spec module" id="module-Encoder" class="anchored"><a href="#module-Encoder" class="anchor"></a><code><span class="keyword">module</span> <a href="Encoder/index.html">Encoder</a> : <a href="../module-type-ENCODER/index.html">ENCODER</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="../module-type-ENCODER/Hash/index.html">Hash</a> := <a href="argument-1-Hash/index.html">Hash</a> <span class="keyword">and</span> <span class="keyword">module</span> <a href="../module-type-ENCODER/Reference/index.html">Reference</a> := <a href="argument-2-Reference/index.html">Reference</a> <span class="keyword">and</span> <span class="keyword">module</span> <a href="../module-type-ENCODER/Common/index.html">Common</a> := <a href="Common/index.html">Common</a></code></div><div><p>The <a href="Encoder/index.html"><code>Encoder</code></a> module constrained by the same <code>Hash</code> module.</p></div></div><div><div class="spec type" id="type-context" class="anchored"><a href="#type-context" class="anchor"></a><code><span class="keyword">type</span> context</code></div><div><p>The type context.</p></div></div><div><div class="spec value" id="val-capabilities" class="anchored"><a href="#val-capabilities" class="anchor"></a><code><span class="keyword">val</span> capabilities : <a href="index.html#type-context">context</a> <span>&#45;&gt;</span> <span><a href="../../Capability/index.html#type-t">Capability.t</a> list</span></code></div><div><p><code>capabilities context</code> returns the current shared capabilities between the client and the server.</p></div></div><div><div class="spec value" id="val-set_capabilities" class="anchored"><a href="#val-set_capabilities" class="anchor"></a><code><span class="keyword">val</span> set_capabilities : <a href="index.html#type-context">context</a> <span>&#45;&gt;</span> <span><a href="../../Capability/index.html#type-t">Capability.t</a> list</span> <span>&#45;&gt;</span> unit</code></div><div><p><code>set_capabilities context cs</code> sets the current capabilities of the <code>context</code>.</p></div></div><div><div class="spec type" id="type-result" class="anchored"><a href="#type-result" class="anchor"></a><code><span class="keyword">type</span> result = [ </code><table><tr id="type-result.Refs" class="anchored"><td class="def constructor"><a href="#type-result.Refs" class="anchor"></a><code>| </code><code>`Refs <span class="keyword">of</span> <a href="Common/index.html#type-advertised_refs">Common.advertised_refs</a></code></td></tr><tr id="type-result.ShallowUpdate" class="anchored"><td class="def constructor"><a href="#type-result.ShallowUpdate" class="anchor"></a><code>| </code><code>`ShallowUpdate <span class="keyword">of</span> <a href="Common/index.html#type-shallow_update">Common.shallow_update</a></code></td></tr><tr id="type-result.Negociation" class="anchored"><td class="def constructor"><a href="#type-result.Negociation" class="anchor"></a><code>| </code><code>`Negociation <span class="keyword">of</span> <a href="Common/index.html#type-acks">Common.acks</a></code></td></tr><tr id="type-result.NegociationResult" class="anchored"><td class="def constructor"><a href="#type-result.NegociationResult" class="anchor"></a><code>| </code><code>`NegociationResult <span class="keyword">of</span> <a href="Common/index.html#type-negociation_result">Common.negociation_result</a></code></td></tr><tr id="type-result.PACK" class="anchored"><td class="def constructor"><a href="#type-result.PACK" class="anchor"></a><code>| </code><code>`PACK <span class="keyword">of</span> <a href="Decoder/index.html#type-flow">Decoder.flow</a></code></td></tr><tr id="type-result.Flush" class="anchored"><td class="def constructor"><a href="#type-result.Flush" class="anchor"></a><code>| </code><code>`Flush</code></td></tr><tr id="type-result.Nothing" class="anchored"><td class="def constructor"><a href="#type-result.Nothing" class="anchor"></a><code>| </code><code>`Nothing</code></td></tr><tr id="type-result.ReadyPACK" class="anchored"><td class="def constructor"><a href="#type-result.ReadyPACK" class="anchor"></a><code>| </code><code>`ReadyPACK <span class="keyword">of</span> <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></td></tr><tr id="type-result.ReportStatus" class="anchored"><td class="def constructor"><a href="#type-result.ReportStatus" class="anchor"></a><code>| </code><code>`ReportStatus <span class="keyword">of</span> <a href="Common/index.html#type-report_status">Common.report_status</a></code></td></tr><tr id="type-result.SmartError" class="anchored"><td class="def constructor"><a href="#type-result.SmartError" class="anchor"></a><code>| </code><code>`SmartError <span class="keyword">of</span> string</code></td></tr></table><code> ]</code></div><div><p>The possible repsonse of the server.</p></div></div><div><div class="spec type" id="type-process" class="anchored"><a href="#type-process" class="anchor"></a><code><span class="keyword">type</span> process = [ </code><table><tr id="type-process.Read" class="anchored"><td class="def constructor"><a href="#type-process.Read" class="anchor"></a><code>| </code><code>`Read <span class="keyword">of</span> <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> * int * int * <span>(int <span>&#45;&gt;</span> <a href="index.html#type-process">process</a>)</span></code></td></tr><tr id="type-process.Write" class="anchored"><td class="def constructor"><a href="#type-process.Write" class="anchor"></a><code>| </code><code>`Write <span class="keyword">of</span> <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> * int * int * <span>(int <span>&#45;&gt;</span> <a href="index.html#type-process">process</a>)</span></code></td></tr><tr id="type-process.Error" class="anchored"><td class="def constructor"><a href="#type-process.Error" class="anchor"></a><code>| </code><code>`Error <span class="keyword">of</span> <a href="Decoder/index.html#type-error">Decoder.error</a> * <a href="../../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> * int</code></td></tr><tr id="type-process.result" class="anchored"><td class="def type"><a href="#type-process.result" class="anchor"></a><code>| </code><code><a href="index.html#type-result">result</a></code></td></tr></table><code> ]</code></div><div><p>The expected actions by the context.</p></div></div><div><div class="spec value" id="val-encode" class="anchored"><a href="#val-encode" class="anchor"></a><code><span class="keyword">val</span> encode : <a href="Encoder/index.html#type-action">Encoder.action</a> <span>&#45;&gt;</span> <span>(<a href="index.html#type-context">context</a> <span>&#45;&gt;</span> <a href="index.html#type-process">process</a>)</span> <span>&#45;&gt;</span> <a href="index.html#type-context">context</a> <span>&#45;&gt;</span> <a href="index.html#type-process">process</a></code></div><div><p><code>encode action k ctx</code> starts to encode an <code>action</code> in the context <code>ctx</code> and call <code>k</code> at the end of the encoding.</p></div></div><div><div class="spec value" id="val-decode" class="anchored"><a href="#val-decode" class="anchor"></a><code><span class="keyword">val</span> decode : <span><span class="type-var">'a</span> <a href="Decoder/index.html#type-transaction">Decoder.transaction</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="index.html#type-context">context</a> <span>&#45;&gt;</span> <a href="index.html#type-process">process</a>)</span> <span>&#45;&gt;</span> <a href="index.html#type-context">context</a> <span>&#45;&gt;</span> <a href="index.html#type-process">process</a></code></div><div><p><code>decode t k ctx</code> starts to decode an expected <a href="Decoder/index.html#type-transaction"><code>Decoder.transaction</code></a> <code>t</code> and call <code>k</code> at the end of the decoding.</p></div></div><div><div class="spec value" id="val-pp_result" class="anchored"><a href="#val-pp_result" class="anchor"></a><code><span class="keyword">val</span> pp_result : <span><a href="index.html#type-result">result</a> <a href="../../../../fmt/Fmt/index.html#type-t">Fmt.t</a></span></code></div><div><p>Pretty-print of <a href="index.html#type-result"><code>result</code></a>.</p></div></div><div><div class="spec type" id="type-action" class="anchored"><a href="#type-action" class="anchor"></a><code><span class="keyword">type</span> action = [ </code><table><tr id="type-action.GitProtoRequest" class="anchored"><td class="def constructor"><a href="#type-action.GitProtoRequest" class="anchor"></a><code>| </code><code>`GitProtoRequest <span class="keyword">of</span> <a href="Common/index.html#type-git_proto_request">Common.git_proto_request</a></code></td></tr><tr id="type-action.Shallow" class="anchored"><td class="def constructor"><a href="#type-action.Shallow" class="anchor"></a><code>| </code><code>`Shallow <span class="keyword">of</span> <span><a href="argument-1-Hash/index.html#type-t">Hash.t</a> list</span></code></td></tr><tr id="type-action.UploadRequest" class="anchored"><td class="def constructor"><a href="#type-action.UploadRequest" class="anchor"></a><code>| </code><code>`UploadRequest <span class="keyword">of</span> <a href="Common/index.html#type-upload_request">Common.upload_request</a></code></td></tr><tr id="type-action.UpdateRequest" class="anchored"><td class="def constructor"><a href="#type-action.UpdateRequest" class="anchor"></a><code>| </code><code>`UpdateRequest <span class="keyword">of</span> <a href="Common/index.html#type-update_request">Common.update_request</a></code></td></tr><tr id="type-action.Has" class="anchored"><td class="def constructor"><a href="#type-action.Has" class="anchor"></a><code>| </code><code>`Has <span class="keyword">of</span> <a href="argument-1-Hash/Set/index.html#type-t">Hash.Set.t</a></code></td></tr><tr id="type-action.Done" class="anchored"><td class="def constructor"><a href="#type-action.Done" class="anchor"></a><code>| </code><code>`Done</code></td></tr><tr id="type-action.Flush" class="anchored"><td class="def constructor"><a href="#type-action.Flush" class="anchor"></a><code>| </code><code>`Flush</code></td></tr><tr id="type-action.ReceivePACK" class="anchored"><td class="def constructor"><a href="#type-action.ReceivePACK" class="anchor"></a><code>| </code><code>`ReceivePACK</code></td></tr><tr id="type-action.SendPACK" class="anchored"><td class="def constructor"><a href="#type-action.SendPACK" class="anchor"></a><code>| </code><code>`SendPACK <span class="keyword">of</span> int</code></td></tr><tr id="type-action.FinishPACK" class="anchored"><td class="def constructor"><a href="#type-action.FinishPACK" class="anchor"></a><code>| </code><code>`FinishPACK <span class="keyword">of</span> <a href="argument-2-Reference/Set/index.html#type-t">Reference.Set.t</a></code></td></tr></table><code> ]</code></div><div><p>Close to <a href="Encoder/index.html#type-action"><code>Encoder.action</code></a> but more exhaustive and context-dependant.</p></div></div><div><div class="spec value" id="val-run" class="anchored"><a href="#val-run" class="anchor"></a><code><span class="keyword">val</span> run : <a href="index.html#type-context">context</a> <span>&#45;&gt;</span> <a href="index.html#type-action">action</a> <span>&#45;&gt;</span> <a href="index.html#type-process">process</a></code></div><div><p><code>run ctx action</code> sends an action to the server and schedule a specific <a href="Decoder/index.html#type-transaction"><code>Decoder.transaction</code></a> then.</p></div></div><div><div class="spec value" id="val-context" class="anchored"><a href="#val-context" class="anchor"></a><code><span class="keyword">val</span> context : <a href="Common/index.html#type-git_proto_request">Common.git_proto_request</a> <span>&#45;&gt;</span> <a href="index.html#type-context">context</a> * <a href="index.html#type-process">process</a></code></div><div><p><code>context request</code> makes a new context and the continuation of the transport.</p></div></div></div></body></html>