<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Syslog_message (syslog-message.Syslog_message)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">syslog-message</a> &#x00BB; Syslog_message</nav><header><h1>Module <code>Syslog_message</code></h1><p>Syslog message parser and unparser</p><p><code>Syslog-message</code> is a module for handling syslog messages, as defined in <a href="https://tools.ietf.org/html/rfc3164">RFC 3164</a>.</p><p>The <code>parse</code> function transforms a string to a syslog message <code>t</code>, using a <span class="xref-unresolved">context</span> of default parameters. Such a message can be transformed into a string <code>to_string</code> or pretty printed <code>pp_string</code>, <code>pp</code>.</p><p><em>1.1.0 - <a href="https://github.com/verbosemode/syslog-message">homepage</a></em></p></header><div class="content"><div><div class="spec type" id="type-facility" class="anchored"><a href="#type-facility" class="anchor"></a><code><span class="keyword">type</span> facility = </code><table><tr id="type-facility.Kernel_Message" class="anchored"><td class="def variant constructor"><a href="#type-facility.Kernel_Message" class="anchor"></a><code>| <span class="constructor">Kernel_Message</span></code></td></tr><tr id="type-facility.User_Level_Messages" class="anchored"><td class="def variant constructor"><a href="#type-facility.User_Level_Messages" class="anchor"></a><code>| <span class="constructor">User_Level_Messages</span></code></td></tr><tr id="type-facility.Mail_System" class="anchored"><td class="def variant constructor"><a href="#type-facility.Mail_System" class="anchor"></a><code>| <span class="constructor">Mail_System</span></code></td></tr><tr id="type-facility.System_Daemons" class="anchored"><td class="def variant constructor"><a href="#type-facility.System_Daemons" class="anchor"></a><code>| <span class="constructor">System_Daemons</span></code></td></tr><tr id="type-facility.Security_Authorization_Messages" class="anchored"><td class="def variant constructor"><a href="#type-facility.Security_Authorization_Messages" class="anchor"></a><code>| <span class="constructor">Security_Authorization_Messages</span></code></td></tr><tr id="type-facility.Messages_Generated_Internally_By_Syslogd" class="anchored"><td class="def variant constructor"><a href="#type-facility.Messages_Generated_Internally_By_Syslogd" class="anchor"></a><code>| <span class="constructor">Messages_Generated_Internally_By_Syslogd</span></code></td></tr><tr id="type-facility.Line_Printer_Subsystem" class="anchored"><td class="def variant constructor"><a href="#type-facility.Line_Printer_Subsystem" class="anchor"></a><code>| <span class="constructor">Line_Printer_Subsystem</span></code></td></tr><tr id="type-facility.Network_News_Subsystem" class="anchored"><td class="def variant constructor"><a href="#type-facility.Network_News_Subsystem" class="anchor"></a><code>| <span class="constructor">Network_News_Subsystem</span></code></td></tr><tr id="type-facility.UUCP_subsystem" class="anchored"><td class="def variant constructor"><a href="#type-facility.UUCP_subsystem" class="anchor"></a><code>| <span class="constructor">UUCP_subsystem</span></code></td></tr><tr id="type-facility.Clock_Daemon" class="anchored"><td class="def variant constructor"><a href="#type-facility.Clock_Daemon" class="anchor"></a><code>| <span class="constructor">Clock_Daemon</span></code></td></tr><tr id="type-facility.Security_Authorization_Messages_10" class="anchored"><td class="def variant constructor"><a href="#type-facility.Security_Authorization_Messages_10" class="anchor"></a><code>| <span class="constructor">Security_Authorization_Messages_10</span></code></td></tr><tr id="type-facility.Ftp_Daemon" class="anchored"><td class="def variant constructor"><a href="#type-facility.Ftp_Daemon" class="anchor"></a><code>| <span class="constructor">Ftp_Daemon</span></code></td></tr><tr id="type-facility.Ntp_Subsystem" class="anchored"><td class="def variant constructor"><a href="#type-facility.Ntp_Subsystem" class="anchor"></a><code>| <span class="constructor">Ntp_Subsystem</span></code></td></tr><tr id="type-facility.Log_Audit" class="anchored"><td class="def variant constructor"><a href="#type-facility.Log_Audit" class="anchor"></a><code>| <span class="constructor">Log_Audit</span></code></td></tr><tr id="type-facility.Log_Alert" class="anchored"><td class="def variant constructor"><a href="#type-facility.Log_Alert" class="anchor"></a><code>| <span class="constructor">Log_Alert</span></code></td></tr><tr id="type-facility.Clock_Daemon_15" class="anchored"><td class="def variant constructor"><a href="#type-facility.Clock_Daemon_15" class="anchor"></a><code>| <span class="constructor">Clock_Daemon_15</span></code></td></tr><tr id="type-facility.Local0" class="anchored"><td class="def variant constructor"><a href="#type-facility.Local0" class="anchor"></a><code>| <span class="constructor">Local0</span></code></td></tr><tr id="type-facility.Local1" class="anchored"><td class="def variant constructor"><a href="#type-facility.Local1" class="anchor"></a><code>| <span class="constructor">Local1</span></code></td></tr><tr id="type-facility.Local2" class="anchored"><td class="def variant constructor"><a href="#type-facility.Local2" class="anchor"></a><code>| <span class="constructor">Local2</span></code></td></tr><tr id="type-facility.Local3" class="anchored"><td class="def variant constructor"><a href="#type-facility.Local3" class="anchor"></a><code>| <span class="constructor">Local3</span></code></td></tr><tr id="type-facility.Local4" class="anchored"><td class="def variant constructor"><a href="#type-facility.Local4" class="anchor"></a><code>| <span class="constructor">Local4</span></code></td></tr><tr id="type-facility.Local5" class="anchored"><td class="def variant constructor"><a href="#type-facility.Local5" class="anchor"></a><code>| <span class="constructor">Local5</span></code></td></tr><tr id="type-facility.Local6" class="anchored"><td class="def variant constructor"><a href="#type-facility.Local6" class="anchor"></a><code>| <span class="constructor">Local6</span></code></td></tr><tr id="type-facility.Local7" class="anchored"><td class="def variant constructor"><a href="#type-facility.Local7" class="anchor"></a><code>| <span class="constructor">Local7</span></code></td></tr></table></div><div><p>The type for Facilities</p></div></div><div class="spec value" id="val-int_of_facility" class="anchored"><a href="#val-int_of_facility" class="anchor"></a><code><span class="keyword">val</span> int_of_facility : <a href="index.html#type-facility">facility</a> <span>&#45;&gt;</span> int</code></div><div class="spec value" id="val-facility_of_int" class="anchored"><a href="#val-facility_of_int" class="anchor"></a><code><span class="keyword">val</span> facility_of_int : int <span>&#45;&gt;</span> <span><a href="index.html#type-facility">facility</a> option</span></code></div><div><div class="spec value" id="val-string_of_facility" class="anchored"><a href="#val-string_of_facility" class="anchor"></a><code><span class="keyword">val</span> string_of_facility : <a href="index.html#type-facility">facility</a> <span>&#45;&gt;</span> string</code></div><div><p><code>string_of_facility f</code> is <code>data</code>, the string representation of <code>f</code>.</p></div></div><div class="spec value" id="val-pp_print_facility" class="anchored"><a href="#val-pp_print_facility" class="anchor"></a><code><span class="keyword">val</span> pp_print_facility : <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-facility">facility</a> <span>&#45;&gt;</span> unit</code></div><div><div class="spec type" id="type-severity" class="anchored"><a href="#type-severity" class="anchor"></a><code><span class="keyword">type</span> severity = </code><table><tr id="type-severity.Emergency" class="anchored"><td class="def variant constructor"><a href="#type-severity.Emergency" class="anchor"></a><code>| <span class="constructor">Emergency</span></code></td></tr><tr id="type-severity.Alert" class="anchored"><td class="def variant constructor"><a href="#type-severity.Alert" class="anchor"></a><code>| <span class="constructor">Alert</span></code></td></tr><tr id="type-severity.Critical" class="anchored"><td class="def variant constructor"><a href="#type-severity.Critical" class="anchor"></a><code>| <span class="constructor">Critical</span></code></td></tr><tr id="type-severity.Error" class="anchored"><td class="def variant constructor"><a href="#type-severity.Error" class="anchor"></a><code>| <span class="constructor">Error</span></code></td></tr><tr id="type-severity.Warning" class="anchored"><td class="def variant constructor"><a href="#type-severity.Warning" class="anchor"></a><code>| <span class="constructor">Warning</span></code></td></tr><tr id="type-severity.Notice" class="anchored"><td class="def variant constructor"><a href="#type-severity.Notice" class="anchor"></a><code>| <span class="constructor">Notice</span></code></td></tr><tr id="type-severity.Informational" class="anchored"><td class="def variant constructor"><a href="#type-severity.Informational" class="anchor"></a><code>| <span class="constructor">Informational</span></code></td></tr><tr id="type-severity.Debug" class="anchored"><td class="def variant constructor"><a href="#type-severity.Debug" class="anchor"></a><code>| <span class="constructor">Debug</span></code></td></tr></table></div><div><p>The type for Severity levels</p></div></div><div class="spec value" id="val-int_of_severity" class="anchored"><a href="#val-int_of_severity" class="anchor"></a><code><span class="keyword">val</span> int_of_severity : <a href="index.html#type-severity">severity</a> <span>&#45;&gt;</span> int</code></div><div class="spec value" id="val-severity_of_int" class="anchored"><a href="#val-severity_of_int" class="anchor"></a><code><span class="keyword">val</span> severity_of_int : int <span>&#45;&gt;</span> <span><a href="index.html#type-severity">severity</a> option</span></code></div><div><div class="spec value" id="val-string_of_severity" class="anchored"><a href="#val-string_of_severity" class="anchor"></a><code><span class="keyword">val</span> string_of_severity : <a href="index.html#type-severity">severity</a> <span>&#45;&gt;</span> string</code></div><div><p><code>string_of_severity s</code> is <code>data</code>, the string representation of <code>s</code>.</p></div></div><div class="spec value" id="val-pp_print_severity" class="anchored"><a href="#val-pp_print_severity" class="anchor"></a><code><span class="keyword">val</span> pp_print_severity : <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-severity">severity</a> <span>&#45;&gt;</span> unit</code></div><div><div class="spec type" id="type-ctx" class="anchored"><a href="#type-ctx" class="anchor"></a><code><span class="keyword">type</span> ctx = {</code><table><tr id="type-ctx.timestamp" class="anchored"><td class="def record field"><a href="#type-ctx.timestamp" class="anchor"></a><code>timestamp : <a href="../../ptime/Ptime/index.html#type-t">Ptime.t</a>;</code></td></tr><tr id="type-ctx.hostname" class="anchored"><td class="def record field"><a href="#type-ctx.hostname" class="anchor"></a><code>hostname : string;</code></td></tr><tr id="type-ctx.set_hostname" class="anchored"><td class="def record field"><a href="#type-ctx.set_hostname" class="anchor"></a><code>set_hostname : bool;</code></td></tr></table><code>}</code></div><div><p><code>ctx</code> provides additional information to the <code>parse</code> function in case one of the sub-parsers fails.</p><ul><li><code>timestamp</code>: A <code>timestamp</code></li><li><code>hostname</code>: Hostname, IPv4 or IPv6 address of the sender. &quot;<i>-</i>&quot; if unknown.</li><li><code>set_hostname</code>: If true, the <code>parse</code> function will skip its hostname sub-parser and use the hostname from <a href="index.html#type-ctx"><code>ctx</code></a> instead.</li></ul><p><code>set_hostname</code> is automatically set by the timestamp sub-parser when it fails, because at this point it is no longer possible to determine the hostname from the input string.</p></div></div><div><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t = {</code><table><tr id="type-t.facility" class="anchored"><td class="def record field"><a href="#type-t.facility" class="anchor"></a><code>facility : <a href="index.html#type-facility">facility</a>;</code></td></tr><tr id="type-t.severity" class="anchored"><td class="def record field"><a href="#type-t.severity" class="anchor"></a><code>severity : <a href="index.html#type-severity">severity</a>;</code></td></tr><tr id="type-t.timestamp" class="anchored"><td class="def record field"><a href="#type-t.timestamp" class="anchor"></a><code>timestamp : <a href="../../ptime/Ptime/index.html#type-t">Ptime.t</a>;</code></td></tr><tr id="type-t.hostname" class="anchored"><td class="def record field"><a href="#type-t.hostname" class="anchor"></a><code>hostname : string;</code></td></tr><tr id="type-t.tag" class="anchored"><td class="def record field"><a href="#type-t.tag" class="anchor"></a><code>tag : string;</code></td></tr><tr id="type-t.content" class="anchored"><td class="def record field"><a href="#type-t.content" class="anchor"></a><code>content : string;</code></td></tr></table><code>}</code></div><div><p>The type for Syslog messages</p></div></div><div><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></div><div><p><code>pp ppf t</code> prints the syslog message <code>t</code> on <code>ppf</code>.</p></div></div><div><div class="spec value" id="val-to_string" class="anchored"><a href="#val-to_string" class="anchor"></a><code><span class="keyword">val</span> to_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></div><div><p><code>to_string t</code> is <code>str</code>, a pretty printed string of syslog message <code>t</code>.</p></div></div><div><div class="spec value" id="val-decode" class="anchored"><a href="#val-decode" class="anchor"></a><code><span class="keyword">val</span> decode : <span>ctx:<a href="index.html#type-ctx">ctx</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>,Â <span>[&gt; <a href="../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a> ]</span>)</span> <a href="../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></span></code></div><div><p><code>decode ~ctx data</code> is <code>t</code>, either <code>Ok t</code>, a successfully decoded syslog message, or <code>Error e</code>.</p></div></div><div><div class="spec value" id="val-encode" class="anchored"><a href="#val-encode" class="anchor"></a><code><span class="keyword">val</span> encode : <span>?&#8288;len:int</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></div><div><p><code>encode ~len t</code> is <code>data</code>, the encoded syslog message <code>t</code>, truncated to <code>len</code> bytes. If <code>len</code> is 0 the output is not truncated.</p><p><em>Warning:</em> Since version 1.0.0, messages are no longer truncated to 1024 bytes by default.</p></div></div><div><div class="spec value" id="val-encode_local" class="anchored"><a href="#val-encode_local" class="anchor"></a><code><span class="keyword">val</span> encode_local : <span>?&#8288;len:int</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></div><div><p><code>encode_local ~len t</code> behaves as <a href="index.html#val-encode"><code>encode</code></a> except that the message is formatted for sending to the local syslog daemon (e.g. on <code>/dev/log</code>).</p></div></div><div><div class="spec module" id="module-Rfc3164_Timestamp" class="anchored"><a href="#module-Rfc3164_Timestamp" class="anchor"></a><code><span class="keyword">module</span> <a href="Rfc3164_Timestamp/index.html">Rfc3164_Timestamp</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>RFC 3164 Timestamps</p></div></div></div></body></html>