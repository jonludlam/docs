<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Rotation (async.Log_extended.Rotation)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">async</a> &#x00BB; <a href="../index.html">Log_extended</a> &#x00BB; Rotation</nav><header><h1>Module <code>Log_extended.Rotation</code></h1></header><div class="content"><div><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></div><div><p>Description of boundaries for file rotation.</p><p>If all fields are <code>None</code> the file will never be rotated. Any field set to <code>Some</code> will cause rotation to happen when that boundary is crossed. Multiple boundaries may be set. Log rotation always causes incrementing rotation conditions (e.g., size) to reset.</p><p>The condition <code>keep</code> is special and does not follow the rules above. When a log is rotated, <code>keep</code> is examined and logs that do not fall under its instructions are deleted. This deletion takes place on rotation only, and so may not happen. The meaning of keep options are:</p><ul><li><code>`All</code> -- never delete</li><li><code>`Newer_than span</code> -- delete files with a timestamp older than <code>Time.sub (Time.now
        ()) span</code>. This normally means keeping files that contain at least one message logged within <code>span</code>. If <code>span</code> is short enough this option can delete a just-rotated file.</li><li><code>`At_least i</code> -- keep the <code>i</code> most recent files</li></ul><p>Log rotation does not support symlinks, and you're encouraged to avoid them in production applications. Issues with symlinks:</p><ul><li>You can't tail symlinks without being careful (e.g., you must remember to pass <code>-F</code> to <code>`tail`</code>).</li><li>Symlinks are hard to reason about when the program crashes, especially on startup (i.e., is the symlink pointing me at the right log file?).</li><li>Atomicity is hard.</li><li>Symlinks encourage tailing, which is a bad way to communicate information.</li><li>They complicate archiving processes (the symlink must be skipped).</li></ul></div></div><div><div class="spec include"><div class="doc"><div class="spec value" id="val-sexp_of_t" class="anchored"><a href="#val-sexp_of_t" class="anchor"></a><code><span class="keyword">val</span> sexp_of_t : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../../sexplib0/Sexplib0/Sexp/index.html#type-t">Ppx_sexp_conv_lib.Sexp.t</a></code></div></div></div></div><div class="spec module-type" id="module-type-Id_intf" class="anchored"><a href="#module-type-Id_intf" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Id_intf/index.html">Id_intf</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : <span>?&#8288;messages:int</span> <span>&#45;&gt;</span> <span>?&#8288;size:<a href="../../../core_kernel/Core_kernel/Byte_units/index.html#type-t">Core.Byte_units.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;time:<a href="../../../core/Core/Time/Ofday/index.html#type-t">Core.Time.Ofday.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;zone:<a href="../../../core/Core/Time/Zone/index.html#type-t">Core.Time.Zone.t</a></span> <span>&#45;&gt;</span> <span>keep:<span>[ `All <span><span>| `Newer_than</span> of <a href="../../../core/Core/Time/Span/index.html#type-t">Core.Time.Span.t</a></span> <span><span>| `At_least</span> of int</span> ]</span></span> <span>&#45;&gt;</span> <span>naming_scheme:<span>[ `Numbered <span>| `Timestamped</span> <span>| `Dated</span> <span><span>| `User_defined</span> of <span>(<span class="keyword">module</span> <a href="module-type-Id_intf/index.html">Id_intf</a>)</span></span> ]</span></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></div><div><div class="spec value" id="val-default" class="anchored"><a href="#val-default" class="anchor"></a><code><span class="keyword">val</span> default : <span>?&#8288;zone:<a href="../../../core/Core/Time/Zone/index.html#type-t">Core.Time.Zone.t</a></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></div><div><p>Sane defaults for log rotation.</p><p>Writes dated log files. Files are rotated every time the day changes in the given zone (uses the machine's zone by default). If the dated log file already exists, it's appended to.</p><p>Logs are never deleted. Best practice is to have an external mechanism archive old logs for long-term storage.</p></div></div></div></body></html>