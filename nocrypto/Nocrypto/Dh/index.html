<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dh (nocrypto.Nocrypto.Dh)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">nocrypto</a> &#x00BB; <a href="../index.html">Nocrypto</a> &#x00BB; Dh</nav><header><h1>Module <code>Nocrypto.Dh</code></h1><p>Diffie-Hellman, MODP version.</p></header><nav class="toc"><ul><li><a href="#diffie-hellman-key-exchange">Diffie-Hellman key exchange</a></li></ul></nav><div class="content"><h2 id="diffie-hellman-key-exchange"><a href="#diffie-hellman-key-exchange" class="anchor"></a>Diffie-Hellman key exchange</h2><div><div class="spec exception" id="exception-Invalid_public_key" class="anchored"><a href="#exception-Invalid_public_key" class="anchor"></a><code><span class="keyword">exception</span> <span class="exception">Invalid_public_key</span></code></div><div><p>Raised if the public key is degenerate. Implies either badly malfunctioning DH on the other side, or an attack attempt.</p></div></div><div><div class="spec type" id="type-group" class="anchored"><a href="#type-group" class="anchor"></a><code><span class="keyword">type</span> group = {</code><table><tr id="type-group.p" class="anchored"><td class="def record field"><a href="#type-group.p" class="anchor"></a><code>p : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p>modulus</p></td></tr><tr id="type-group.gg" class="anchored"><td class="def record field"><a href="#type-group.gg" class="anchor"></a><code>gg : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p>generator</p></td></tr><tr id="type-group.q" class="anchored"><td class="def record field"><a href="#type-group.q" class="anchor"></a><code>q : <span><a href="../../../zarith/Z/index.html#type-t">Z.t</a> option</span>;</code></td><td class="doc"><p>subgroup order; potentially unknown</p></td></tr></table><code>}</code></div><div><p>A DH group.</p><p><em><code>Sexplib</code> convertible</em>.</p></div></div><div><div class="spec type" id="type-secret" class="anchored"><a href="#type-secret" class="anchor"></a><code><span class="keyword">type</span> secret = <span class="keyword">private</span> {</code><table><tr id="type-secret.x" class="anchored"><td class="def record field"><a href="#type-secret.x" class="anchor"></a><code>x : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td></tr></table><code>}</code></div><div><p>A private secret.</p><p><em><code>Sexplib</code> convertible.</em></p></div></div><div><div class="spec value" id="val-modulus_size" class="anchored"><a href="#val-modulus_size" class="anchor"></a><code><span class="keyword">val</span> modulus_size : <a href="index.html#type-group">group</a> <span>&#45;&gt;</span> int</code></div><div><p>Bit size of the modulus.</p></div></div><div><div class="spec value" id="val-key_of_secret" class="anchored"><a href="#val-key_of_secret" class="anchor"></a><code><span class="keyword">val</span> key_of_secret : <a href="index.html#type-group">group</a> <span>&#45;&gt;</span> <span>s:<a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></span> <span>&#45;&gt;</span> <a href="index.html#type-secret">secret</a> * <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></div><div><p><code>key_of_secret group s</code> is the <a href="index.html#type-secret"><code>secret</code></a> and the corresponding public key which use <code>s</code> as the secret exponent.</p><dl><dt>raises Invalid_public_key</dt><dd><p>if <code>s</code> is degenerate.</p></dd></dl></div></div><div><div class="spec value" id="val-gen_key" class="anchored"><a href="#val-gen_key" class="anchor"></a><code><span class="keyword">val</span> gen_key : <span>?&#8288;g:<a href="../Rng/index.html#type-g">Rng.g</a></span> <span>&#45;&gt;</span> <span>?&#8288;bits:int</span> <span>&#45;&gt;</span> <a href="index.html#type-group">group</a> <span>&#45;&gt;</span> <a href="index.html#type-secret">secret</a> * <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></div><div><p>Generate a random <a href="index.html#type-secret"><code>secret</code></a> and the corresponding public key. <code>bits</code> is the exact bit-size of <a href="index.html#type-secret"><code>secret</code></a> and defaults to a value dependent on the <a href="index.html#type-group"><code>group</code></a>'s <code>p</code>.</p></div></div><div><div class="spec value" id="val-shared" class="anchored"><a href="#val-shared" class="anchor"></a><code><span class="keyword">val</span> shared : <a href="index.html#type-group">group</a> <span>&#45;&gt;</span> <a href="index.html#type-secret">secret</a> <span>&#45;&gt;</span> <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> <span>&#45;&gt;</span> <span><a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> option</span></code></div><div><p><code>shared group secret message</code> is <code>Some key</code>, the shared key, given a group, a previously generated <a href="index.html#type-secret"><code>secret</code></a> and the other party's public message. It is <code>None</code> if <code>message</code> is degenerate.</p></div></div><div><div class="spec value" id="val-gen_group" class="anchored"><a href="#val-gen_group" class="anchor"></a><code><span class="keyword">val</span> gen_group : <span>?&#8288;g:<a href="../Rng/index.html#type-g">Rng.g</a></span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-group">group</a></code></div><div><p><code>gen_group bits</code> generates a random <a href="index.html#type-group"><code>group</code></a> with modulus size <code>bits</code>. Uses a safe prime <code>p = 2q + 1</code> (with <code>q</code> prime) for the modulus and <code>2</code> for the generator, such that <code>2^q = 1 mod p</code>. Runtime is on the order of minute for 1024 bits.</p><dl><dt>raises Invalid_argument</dt><dd><p>if <code>bits</code> is ridiculously small.</p></dd></dl></div></div><div><div class="spec module" id="module-Group" class="anchored"><a href="#module-Group" class="anchor"></a><code><span class="keyword">module</span> <a href="Group/index.html">Group</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p>A small catalog of standardized <a href="index.html#type-group"><code>group</code></a>s.</p></div></div></div></body></html>