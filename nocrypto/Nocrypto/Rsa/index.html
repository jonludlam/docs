<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Rsa (nocrypto.Nocrypto.Rsa)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">nocrypto</a> &#x00BB; <a href="../index.html">Nocrypto</a> &#x00BB; Rsa</nav><header><h1>Module <code>Nocrypto.Rsa</code></h1><p><b>RSA</b> public-key cryptography.</p><p>Keys are taken to be trusted material, and their properties are not checked.</p><p>Messages are checked not to exceed the key size, and this is signalled via exceptions.</p><p>Private-key operations are optionally protected through RSA blinding.</p></header><nav class="toc"><ul><li><a href="#rsa-public-key-encryption">RSA public-key encryption</a></li><li><a href="#pkcs#1-padded-modes">PKCS#1 padded modes</a></li></ul></nav><div class="content"><h2 id="rsa-public-key-encryption"><a href="#rsa-public-key-encryption" class="anchor"></a>RSA public-key encryption</h2><div><div class="spec exception" id="exception-Insufficient_key" class="anchored"><a href="#exception-Insufficient_key" class="anchor"></a><code><span class="keyword">exception</span> <span class="exception">Insufficient_key</span></code></div><div><p>Raised if the key is too small to transform the given message, i.e. if the numerical interpretation of the (potentially padded) message is not smaller than the modulus.</p><p>It is additionally raised if the message is <code>0</code> and the mode does not involve padding.</p></div></div><div><div class="spec type" id="type-pub" class="anchored"><a href="#type-pub" class="anchor"></a><code><span class="keyword">type</span> pub = {</code><table><tr id="type-pub.e" class="anchored"><td class="def record field"><a href="#type-pub.e" class="anchor"></a><code>e : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p>Public exponent</p></td></tr><tr id="type-pub.n" class="anchored"><td class="def record field"><a href="#type-pub.n" class="anchor"></a><code>n : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p>Modulus</p></td></tr></table><code>}</code></div><div><p>Public key.</p><p><em><code>Sexplib</code> convertible</em>.</p></div></div><div><div class="spec type" id="type-priv" class="anchored"><a href="#type-priv" class="anchor"></a><code><span class="keyword">type</span> priv = {</code><table><tr id="type-priv.e" class="anchored"><td class="def record field"><a href="#type-priv.e" class="anchor"></a><code>e : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p>Public exponent</p></td></tr><tr id="type-priv.d" class="anchored"><td class="def record field"><a href="#type-priv.d" class="anchor"></a><code>d : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p>Private exponent</p></td></tr><tr id="type-priv.n" class="anchored"><td class="def record field"><a href="#type-priv.n" class="anchor"></a><code>n : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p>Modulus</p></td></tr><tr id="type-priv.p" class="anchored"><td class="def record field"><a href="#type-priv.p" class="anchor"></a><code>p : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p>Prime factor <code>p</code></p></td></tr><tr id="type-priv.q" class="anchored"><td class="def record field"><a href="#type-priv.q" class="anchor"></a><code>q : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p>Prime factor <code>q</code></p></td></tr><tr id="type-priv.dp" class="anchored"><td class="def record field"><a href="#type-priv.dp" class="anchor"></a><code>dp : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p><code>d mod (p-1)</code></p></td></tr><tr id="type-priv.dq" class="anchored"><td class="def record field"><a href="#type-priv.dq" class="anchor"></a><code>dq : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p><code>d mod (q-1)</code></p></td></tr><tr id="type-priv.q'" class="anchored"><td class="def record field"><a href="#type-priv.q'" class="anchor"></a><code>q' : <a href="../../../zarith/Z/index.html#type-t">Z.t</a>;</code></td><td class="doc"><p><code>q^(-1) mod p</code></p></td></tr></table><code>}</code></div><div><p>Private key (two-factor version).</p><p><em><code>Sexplib</code> convertible</em>.</p></div></div><div><div class="spec type" id="type-mask" class="anchored"><a href="#type-mask" class="anchor"></a><code><span class="keyword">type</span> mask = [ </code><table><tr id="type-mask.No" class="anchored"><td class="def constructor"><a href="#type-mask.No" class="anchor"></a><code>| </code><code>`No</code></td></tr><tr id="type-mask.Yes" class="anchored"><td class="def constructor"><a href="#type-mask.Yes" class="anchor"></a><code>| </code><code>`Yes</code></td></tr><tr id="type-mask.Yes_with" class="anchored"><td class="def constructor"><a href="#type-mask.Yes_with" class="anchor"></a><code>| </code><code>`Yes_with <span class="keyword">of</span> <a href="../Rng/index.html#type-g">Rng.g</a></code></td></tr></table><code> ]</code></div><div><p>Masking (cryptographic blinding) option.</p></div></div><div><div class="spec value" id="val-pub_bits" class="anchored"><a href="#val-pub_bits" class="anchor"></a><code><span class="keyword">val</span> pub_bits : <a href="index.html#type-pub">pub</a> <span>&#45;&gt;</span> int</code></div><div><p>Bit-size of a public key.</p></div></div><div><div class="spec value" id="val-priv_bits" class="anchored"><a href="#val-priv_bits" class="anchor"></a><code><span class="keyword">val</span> priv_bits : <a href="index.html#type-priv">priv</a> <span>&#45;&gt;</span> int</code></div><div><p>Bit-size of a private key.</p></div></div><div><div class="spec value" id="val-priv_of_primes" class="anchored"><a href="#val-priv_of_primes" class="anchor"></a><code><span class="keyword">val</span> priv_of_primes : <span>e:<a href="../../../zarith/Z/index.html#type-t">Z.t</a></span> <span>&#45;&gt;</span> <span>p:<a href="../../../zarith/Z/index.html#type-t">Z.t</a></span> <span>&#45;&gt;</span> <span>q:<a href="../../../zarith/Z/index.html#type-t">Z.t</a></span> <span>&#45;&gt;</span> <a href="index.html#type-priv">priv</a></code></div><div><p><code>priv_of_primes e p q</code> creates <a href="index.html#type-priv">priv</a> from a minimal description: the public exponent and the two primes.</p></div></div><div><div class="spec value" id="val-pub_of_priv" class="anchored"><a href="#val-pub_of_priv" class="anchor"></a><code><span class="keyword">val</span> pub_of_priv : <a href="index.html#type-priv">priv</a> <span>&#45;&gt;</span> <a href="index.html#type-pub">pub</a></code></div><div><p>Extract the public component from a private key.</p></div></div><div><div class="spec value" id="val-encrypt" class="anchored"><a href="#val-encrypt" class="anchor"></a><code><span class="keyword">val</span> encrypt : <span>key:<a href="index.html#type-pub">pub</a></span> <span>&#45;&gt;</span> <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> <span>&#45;&gt;</span> <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></div><div><p><code>encrypt key message</code> is the encrypted <code>message</code>.</p><dl><dt>raises Insufficient_key</dt><dd><p>(see <span class="xref-unresolved">Insufficient_key</span>)</p></dd></dl></div></div><div><div class="spec value" id="val-decrypt" class="anchored"><a href="#val-decrypt" class="anchor"></a><code><span class="keyword">val</span> decrypt : <span>?&#8288;mask:<a href="index.html#type-mask">mask</a></span> <span>&#45;&gt;</span> <span>key:<a href="index.html#type-priv">priv</a></span> <span>&#45;&gt;</span> <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a> <span>&#45;&gt;</span> <a href="../../../cstruct/Cstruct/index.html#type-t">Cstruct.t</a></code></div><div><p><code>decrypt mask key ciphertext</code> is the decrypted <code>ciphertext</code>, left-padded with <code>0x00</code> up to <code>key</code> size.</p><dl><dt>raises Insufficient_key</dt><dd><p>(see <span class="xref-unresolved">Insufficient_key</span>)</p></dd></dl></div></div><div><div class="spec value" id="val-generate" class="anchored"><a href="#val-generate" class="anchor"></a><code><span class="keyword">val</span> generate : <span>?&#8288;g:<a href="../Rng/index.html#type-g">Rng.g</a></span> <span>&#45;&gt;</span> <span>?&#8288;e:<a href="../../../zarith/Z/index.html#type-t">Z.t</a></span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-priv">priv</a></code></div><div><p><code>generate g e bits</code> is a new <a href="index.html#type-priv">priv</a>. <code>e</code> defaults to <code>2^16+1</code>.</p><dl><dt>raises Invalid_argument</dt><dd><p>if <code>e</code> is bad or <code>bits</code> is too small.</p></dd></dl></div></div><h2 id="pkcs#1-padded-modes"><a href="#pkcs#1-padded-modes" class="anchor"></a>PKCS#1 padded modes</h2><div><div class="spec module" id="module-PKCS1" class="anchored"><a href="#module-PKCS1" class="anchor"></a><code><span class="keyword">module</span> <a href="PKCS1/index.html">PKCS1</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p><b>PKCS v1.5</b>-padded operations, as defined by <b>PKCS #1 v1.5</b>.</p></div></div><div><div class="spec module" id="module-OAEP" class="anchored"><a href="#module-OAEP" class="anchor"></a><code><span class="keyword">module</span> <a href="OAEP/index.html">OAEP</a> : <span class="keyword">functor</span> (<a href="OAEP/argument-1-H/index.html">H</a> : <a href="../Hash/module-type-S/index.html">Hash.S</a>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p><b>OAEP</b>-padded encryption, as defined by <b>PKCS #1 v2.1</b>.</p></div></div><div><div class="spec module" id="module-PSS" class="anchored"><a href="#module-PSS" class="anchor"></a><code><span class="keyword">module</span> <a href="PSS/index.html">PSS</a> : <span class="keyword">functor</span> (<a href="PSS/argument-1-H/index.html">H</a> : <a href="../Hash/module-type-S/index.html">Hash.S</a>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div><p><b>PSS</b>-based signing, as defined by <b>PKCS #1 v2.1</b>.</p></div></div></div></body></html>