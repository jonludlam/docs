<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>foreign (functoria.Functoria_app.DSL.foreign)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> – <a href="../../../index.html">functoria</a> &#x00BB; <a href="../../index.html">Functoria_app</a> &#x00BB; <a href="../index.html">DSL</a> &#x00BB; foreign</nav><header><h1>Class <code>DSL.foreign</code></h1><p>This class can be inherited to define a <a href="../class-type-configurable/index.html"><code>configurable</code></a> with an API similar to <a href="index.html"><code>foreign</code></a>.</p><p>In particular, it allows dynamic packages. Here is an example:</p><pre><code>let main = impl @@ object
    inherit [_] foreign
        &quot;Unikernel.Main&quot; (console @-&gt; job)
    method packages = Key.(if_ is_xen)
        [package ~sublibs:[&quot;xen&quot;] &quot;vchan&quot;]
        [package ~sublibs:[&quot;lwt&quot;] &quot;vchan&quot;]
  end</code></pre></header><div class="content"><div><div class="spec method" id="method-ty" class="anchored"><a href="#method-ty" class="anchor"></a><code><span class="keyword">method</span> ty : <span><span class="type-var">'ty</span> <a href="../index.html#type-typ">typ</a></span></code></div><div><p><code>ty</code> is the module type of the configurable.</p></div></div><div><div class="spec method" id="method-name" class="anchored"><a href="#method-name" class="anchor"></a><code><span class="keyword">method</span> name : string</code></div><div><p><code>name</code> is the unique variable name holding the runtime state of the configurable.</p></div></div><div><div class="spec method" id="method-module_name" class="anchored"><a href="#method-module_name" class="anchor"></a><code><span class="keyword">method</span> module_name : string</code></div><div><p><code>module_name</code> is the name of the module implementing the configurable.</p></div></div><div><div class="spec method" id="method-packages" class="anchored"><a href="#method-packages" class="anchor"></a><code><span class="keyword">method</span> packages : <span><span><a href="../index.html#type-package">package</a> list</span> <a href="../index.html#type-value">value</a></span></code></div><div><p><code>packages</code> is the list of OPAM packages which needs to be installed before compiling the configurable.</p></div></div><div><div class="spec method" id="method-connect" class="anchored"><a href="#method-connect" class="anchor"></a><code><span class="keyword">method</span> connect : <a href="../../../Functoria/Info/index.html#type-t">Info.t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>string list</span> <span>&#45;&gt;</span> string</code></div><div><p><code>connect info mod args</code> is the code to execute in order to initialize the state associated with the module <code>mod</code> (usually calling <code>mod.connect</code>) with the arguments <code>args</code>, in the context of the project information <code>info</code>.</p></div></div><div><div class="spec method" id="method-configure" class="anchored"><a href="#method-configure" class="anchor"></a><code><span class="keyword">method</span> configure : <a href="../../../Functoria/Info/index.html#type-t">Info.t</a> <span>&#45;&gt;</span> <span><span>(unit, <a href="../../../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a>)</span> <a href="../../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></span></code></div><div><p><code>configure info</code> is the code to execute in order to configure the device. During the configuration phase, the specficied <code>packages</code> might not yet be there. The code might involve generating more OCaml code, running shell scripts, etc.</p></div></div><div><div class="spec method" id="method-build" class="anchored"><a href="#method-build" class="anchor"></a><code><span class="keyword">method</span> build : <a href="../../../Functoria/Info/index.html#type-t">Info.t</a> <span>&#45;&gt;</span> <span><span>(unit, <a href="../../../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a>)</span> <a href="../../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></span></code></div><div><p><code>build info</code> is the code to execute in order to build the device. During the build phase, you can rely that all <code>packages</code> are installed (via opam). The code might involve generating more OCaml code (crunching directories), running shell scripts, etc.</p></div></div><div><div class="spec method" id="method-clean" class="anchored"><a href="#method-clean" class="anchor"></a><code><span class="keyword">method</span> clean : <a href="../../../Functoria/Info/index.html#type-t">Info.t</a> <span>&#45;&gt;</span> <span><span>(unit, <a href="../../../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a>)</span> <a href="../../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></span></code></div><div><p><code>clean info</code> is the code to clean-up what has been generated by <code>build</code> and <code>configure</code>.</p></div></div><div><div class="spec method" id="method-keys" class="anchored"><a href="#method-keys" class="anchor"></a><code><span class="keyword">method</span> keys : <span><a href="../index.html#type-key">key</a> list</span></code></div><div><p><code>keys</code> is the list of command-line keys to set-up the configurable.</p></div></div><div><div class="spec method" id="method-deps" class="anchored"><a href="#method-deps" class="anchor"></a><code><span class="keyword">method</span> deps : <span><a href="../index.html#type-abstract_impl">abstract_impl</a> list</span></code></div><div><p><code>deps</code> is the list of <span class="xref-unresolved">abstract implementations</span> that must be initialized before calling <code>connect</code>.</p></div></div></div></body></html>