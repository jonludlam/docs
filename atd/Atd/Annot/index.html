<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Annot (atd.Atd.Annot)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">atd</a> &#x00BB; <a href="../index.html">Atd</a> &#x00BB; Annot</nav><header><h1>Module <code>Atd.Annot</code></h1></header><div class="content"><aside><p>Utilities for interpreting annotations of type <a href="../Ast/index.html#type-annot"><code>Ast.annot</code></a></p></aside><div><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t = <a href="../Ast/index.html#type-annot">Ast.annot</a></code></div><div><p>Sample annotation in ATD syntax with legend:</p><pre>section a   section b
----------- ------
&lt;a a1=&quot;x1&quot;&gt; &lt;b b1&gt;
 | |  |        |
 | |  |        +- field without a value
 | |  |
 | |  +- field value
 | |
 | +- field name
 |
 +- section name</pre><p>The following rules must be followed for a proper use of this module:</p><ul><li>There may not be two sections with the same name. The <code>merge</code> function can be used to merge sections.</li><li>Section order doesn't matter as long as section names are unique.</li><li>Field names within a section should be unique. If not, only the first occurrence of each field is meaningful.</li><li>Field values may be arbitrary strings.</li></ul></div></div><div><div class="spec value" id="val-has_section" class="anchored"><a href="#val-has_section" class="anchor"></a><code><span class="keyword">val</span> has_section : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></div><div><p>Return true if such a section (first-level key) exists.</p></div></div><div><div class="spec value" id="val-has_field" class="anchored"><a href="#val-has_field" class="anchor"></a><code><span class="keyword">val</span> has_field : <span>sections:<span>string list</span></span> <span>&#45;&gt;</span> <span>field:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></div><div><p><code>has_field section_names field_name annotations</code> returns true if at least one section exists with a name in <code>section_names</code> and one of its fields named <code>field_name</code>.</p><p>Each section should be unique.</p></div></div><div><div class="spec value" id="val-get_flag" class="anchored"><a href="#val-get_flag" class="anchor"></a><code><span class="keyword">val</span> get_flag : <span>sections:<span>string list</span></span> <span>&#45;&gt;</span> <span>field:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></div><div><p><code>get_flag section_names field_name</code> looks sequentially into the sections specified by <code>section_names</code> for a field named <code>field_name</code>. If no such field can be found in any section, the result is <code>false</code>. Otherwise, the search stops with the first field matching one of the section names and the field name. If the field has no associated value, the result is <code>true</code>. If the field value is <code>&quot;true&quot;</code> then <code>true</code> is returned. Likewise, if the field value is <code>&quot;false&quot;</code> then <code>false</code> is returned. If the field value is anything else, a <code>Failure</code> exception is raised.</p><p>Each section should be unique.</p><p>Given the following annotations in the ATD syntax noted <code>a</code>:</p><pre>&lt;ocaml openin=&quot;false&quot;&gt; &lt;ocaml_312 openin&gt;</pre><p>We obtain the following results:</p><pre># get_flag \[&quot;ocaml_312&quot;; &quot;ocaml&quot;\] &quot;openin&quot; a;;
\- : true
# get_flag \[&quot;ocaml_311&quot;; &quot;ocaml&quot;\] &quot;openin&quot; a;;
\- : false
# get_flag \[&quot;ocaml_312&quot;\] &quot;openin&quot; a;;
\- : true
# get_flag \[&quot;ocaml_311&quot;\] &quot;openin&quot; a;;
\- : false
# get_flag \[&quot;ocaml&quot;\] &quot;openin&quot; a;;
\- : false</pre></div></div><div><div class="spec value" id="val-get_field" class="anchored"><a href="#val-get_field" class="anchor"></a><code><span class="keyword">val</span> get_field : <span>parse:<span>(string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> option</span>)</span></span> <span>&#45;&gt;</span> <span>default:<span class="type-var">'a</span></span> <span>&#45;&gt;</span> <span>sections:<span>string list</span></span> <span>&#45;&gt;</span> <span>field:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></div><div><p><code>get_field parse default section_names field_name annotations</code> looks sequentially into the sections specified by <code>section_names</code> for a field named <code>field_name</code>. If no such field exists, the <code>default</code> value is returned. If the field is present, the associated value is parsed using the given function <code>parse</code> which should return <code>None</code> in order to indicate an invalid value. If the field is present without an associated value or if <code>parse</code> returns <code>None</code>, a <code>Failure</code> exception is raised.</p><p>Each section should be unique.</p></div></div><div><div class="spec value" id="val-get_opt_field" class="anchored"><a href="#val-get_opt_field" class="anchor"></a><code><span class="keyword">val</span> get_opt_field : <span>parse:<span>(string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> option</span>)</span></span> <span>&#45;&gt;</span> <span>sections:<span>string list</span></span> <span>&#45;&gt;</span> <span>field:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> option</span></code></div><div><p>This is the same as <code>get_field</code> except that no default value for the field exists.</p></div></div><div><div class="spec value" id="val-set_field" class="anchored"><a href="#val-set_field" class="anchor"></a><code><span class="keyword">val</span> set_field : <span>loc:<a href="../Ast/index.html#type-loc">Ast.loc</a></span> <span>&#45;&gt;</span> <span>section:string</span> <span>&#45;&gt;</span> <span>field:string</span> <span>&#45;&gt;</span> <span>string option</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></div><div><p><code>set_field loc section_name field_name value annotations</code> sets a field, reusing existing section <code>section_name</code> if it exists, preserving the position of field <code>field_name</code> and overwriting its value if it exists.</p></div></div><div><div class="spec value" id="val-merge" class="anchored"><a href="#val-merge" class="anchor"></a><code><span class="keyword">val</span> merge : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></div><div><p>Merge sections of the same name together, and keeps only the first occurrence of each field.</p><pre>&lt;a a1=&quot;x1&quot;&gt; &lt;b&gt; &lt;a a2=&quot;x3&quot; a1=&quot;x2&quot;&gt;</pre><p>becomes</p><pre>&lt;a a1=&quot;x1&quot; a2=&quot;x3&quot;&gt; &lt;b&gt;</pre></div></div><div><div class="spec value" id="val-create_id" class="anchored"><a href="#val-create_id" class="anchor"></a><code><span class="keyword">val</span> create_id : unit <span>&#45;&gt;</span> string</code></div><div><p>Create a unique numeric ID</p></div></div></div></body></html>