<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Src (metrics.Metrics.Src)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> – <a href="../../index.html">metrics</a> &#x00BB; <a href="../index.html">Metrics</a> &#x00BB; Src</nav><header><h1>Module <code>Metrics.Src</code></h1><p>Metric sources.</p></header><nav class="toc"><ul><li><a href="#sources">Sources</a><ul><li><a href="#listing-sources">Listing Sources</a></li></ul></li></ul></nav><div class="content"><h3 id="sources"><a href="#sources" class="anchor"></a>Sources</h3><div><div class="spec value" id="val-v" class="anchored"><a href="#val-v" class="anchor"></a><code><span class="keyword">val</span> v : <span>?&#8288;doc:string</span> <span>&#45;&gt;</span> <span>?&#8288;duration:bool</span> <span>&#45;&gt;</span> <span>?&#8288;status:bool</span> <span>&#45;&gt;</span> <span>tags:<span><span class="type-var">'a</span> <a href="../Tags/index.html#type-t">Tags.t</a></span></span> <span>&#45;&gt;</span> <span>data:<span class="type-var">'b</span></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../index.html#type-src">src</a></span></code></div><div><p><code>v ?doc ~tags name</code> is a new source, accepting arbitrary data points. <code>name</code> is the name of the source; it doesn't need to be unique but it is good practice to prefix the name with the name of your package or library (e.g. <code>&quot;mypkg.network&quot;</code>). <code>doc</code> is a documentation string describing the source, defaults to <code>&quot;undocumented&quot;</code>. <code>tags</code> is the collection if (typed) tags which will be used to tag and index the measure and are used identify the various metrics. The source will be enabled on creation iff one of tag in <code>tags</code> has been enabled with <a href="../index.html#val-enable_tag"><code>enable_tag</code></a>.</p><p>For instance, to create a metric to collect CPU and memory usage on various machines, indexed by <code>PID</code>, <code>host</code> name and <code>IP</code> address:</p><pre><code>let src =
   let ipaddr = Tags.v Ipaddr.pp_hum in
   let tags = Tags.[string &quot;host&quot;; ipaddr &quot;IP&quot; ; int &quot;PID&quot; ; ] in
   let data () = Data.v [float &quot;%CPU&quot; (...); int &quot;MEM&quot; (...); ] in
   Src.v &quot;top&quot; ~tags ~data ~doc:&quot;Information about processess&quot;</code></pre></div></div><h4 id="listing-sources"><a href="#listing-sources" class="anchor"></a>Listing Sources</h4><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t = </code><table><tr id="type-t.Src" class="anchored"><td class="def variant constructor"><a href="#type-t.Src" class="anchor"></a><code>| <span class="constructor">Src</span> : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../index.html#type-src">src</a></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></td><td class="doc"><p>The type for metric sources.</p></td></tr></table></div><div><div class="spec value" id="val-list" class="anchored"><a href="#val-list" class="anchor"></a><code><span class="keyword">val</span> list : unit <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> list</span></code></div><div><p><code>list ()</code> is the current exisiting source list.</p></div></div><div><div class="spec value" id="val-name" class="anchored"><a href="#val-name" class="anchor"></a><code><span class="keyword">val</span> name : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></div><div><p><code>name src</code> is <code>src</code>'s name.</p></div></div><div><div class="spec value" id="val-doc" class="anchored"><a href="#val-doc" class="anchor"></a><code><span class="keyword">val</span> doc : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></div><div><p><code>doc src</code> is <code>src</code>'s documentation string.</p></div></div><div><div class="spec value" id="val-tags" class="anchored"><a href="#val-tags" class="anchor"></a><code><span class="keyword">val</span> tags : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string list</span></code></div><div><p><code>tags src</code> is the list of <code>src</code>'s tag names.</p></div></div><div><div class="spec value" id="val-data" class="anchored"><a href="#val-data" class="anchor"></a><code><span class="keyword">val</span> data : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string list</span></code></div><div><p><code>fields src</code> is the list of <code>src</code>'s data field names. Note that these are updated dynamically, so a monitoring function has to be called first.</p></div></div><div><div class="spec value" id="val-equal" class="anchored"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></div><div><p><code>equal src src'</code> is <code>true</code> iff <code>src</code> and <code>src'</code> are the same source.</p></div></div><div><div class="spec value" id="val-compare" class="anchored"><a href="#val-compare" class="anchor"></a><code><span class="keyword">val</span> compare : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></div><div><p><code>compare src src'</code> is a total order on sources.</p></div></div><div><div class="spec value" id="val-duration" class="anchored"><a href="#val-duration" class="anchor"></a><code><span class="keyword">val</span> duration : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></div><div><p><code>duration t</code> is true iff <code>t</code> is a <code>fn</code> source and <code>t</code> requires automatic duration recording.</p></div></div><div><div class="spec value" id="val-status" class="anchored"><a href="#val-status" class="anchor"></a><code><span class="keyword">val</span> status : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></div><div><p><code>status t</code> is true iff <code>t</code> is a <code>fn</code> source and <code>t</code> requires automatic duration recording.</p></div></div><div><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : <span><a href="index.html#type-t">t</a> <a href="../../../fmt/Fmt/index.html#type-t">Fmt.t</a></span></code></div><div><p><code>pp ppf src</code> prints an unspecified representation of <code>src</code> on <code>ppf</code>.</p></div></div><div><div class="spec value" id="val-is_active" class="anchored"><a href="#val-is_active" class="anchor"></a><code><span class="keyword">val</span> is_active : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></div><div><p><code>is_active t</code> is true iff <code>t</code> is enabled.</p></div></div><div><div class="spec value" id="val-enable" class="anchored"><a href="#val-enable" class="anchor"></a><code><span class="keyword">val</span> enable : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></div><div><p><code>enable src</code> enables the metric source <code>src</code>.</p></div></div><div><div class="spec value" id="val-disable" class="anchored"><a href="#val-disable" class="anchor"></a><code><span class="keyword">val</span> disable : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></div><div><p><code>disable src</code> disables the metric source <code>src</code>.</p></div></div></div></body></html>