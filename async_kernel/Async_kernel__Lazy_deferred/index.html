<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Async_kernel__Lazy_deferred (async_kernel.Async_kernel__Lazy_deferred)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">async_kernel</a> &#x00BB; Async_kernel__Lazy_deferred</nav><header><h1>Module <code>Async_kernel__Lazy_deferred</code></h1><p>A delayed computation that can produce a deferred.</p><p>Nothing happens with a lazy deferred unless one <code>force</code>s it. Forcing a lazy deferred starts the computation, which will eventually cause the deferred to become determined. As usual with laziness, multiply forcing a lazy deferred is no different than forcing it a single time.</p><p>Exceptions (both synchronous and asynchronous) raised by a delayed computation are returned by <code>force</code> (<code>wait</code>, <code>peek</code>, etc.), or will be raised to the monitor in effect when <code>force_exn</code> (<code>wait_exn</code>, <code>peek_exn</code>, etc.) was called.</p><p>The type is not exposed nor defined as <code>'a Deferred.t Lazy.t</code> or <code>'a Or_error.t
    Deferred.t Lazy.t</code>, because there is a difference in power with these types. Any value of type <code>'a Deferred.t Lazy.t</code> would mishandle asynchronous exceptions in the computation of <code>'a</code>. For instance, the following code blocks forever regardless of how <code>v</code> is defined:</p><pre><code>let v : Nothing.t Deferred.t Lazy.t = lazy (return &quot;&quot; &gt;&gt;| failwith) in
let%bind _ = try_with (fun () -&gt; force v) in
let%bind _ = try_with (fun () -&gt; force v) in</code></pre><p>There is no <code>val of_lazy : 'a Deferred.t Lazy.t -&gt; 'a t</code> because of the difference in power.</p><p>See also <code>Deferred.Memo.unit</code>, if you only are interested in <code>create</code> and <code>force</code>.</p></header><div class="content"></div></body></html>