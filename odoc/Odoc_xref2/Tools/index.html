<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tools (odoc.Odoc_xref2.Tools)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc v1.1.1-1373-g2e7c1c75"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><nav><a href="../index.html">Up</a> – <a href="../../index.html">odoc</a> &#x00BB; <a href="../index.html">Odoc_xref2</a> &#x00BB; Tools</nav><header><h1>Module <code>Odoc_xref2.Tools</code></h1></header><nav class="toc"><ul><li><a href="#lookup-and-resolve-functions">Lookup and resolve functions</a><ul><li><a href="#convenience-functions">Convenience functions</a></li></ul></li><li><a href="#re-resolve-functions">Re-resolve functions</a></li><li><a href="#ref_tools-helpers">Ref_tools helpers</a></li><li><a href="#fragment-resolution">Fragment resolution</a></li><li><a href="#fragmap-functions">Fragmap functions</a></li><li><a href="#cache-handling">Cache handling</a></li></ul></nav><div class="content"><aside><p>Tools for manipulating the component data structures</p><p>This module contains tools for manipulating the <a href="../Component/index.html"><code>Component</code></a> data structures, for example, resolving paths and fragments, obtaining signatures, handling fragment substitution and others.</p></aside><div class="spec module" id="module-ResolvedMonad" class="anchored"><a href="#module-ResolvedMonad" class="anchor"></a><code><span class="keyword">module</span> <a href="ResolvedMonad/index.html">ResolvedMonad</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><h3 id="lookup-and-resolve-functions"><a href="#lookup-and-resolve-functions" class="anchor"></a>Lookup and resolve functions</h3><aside><p>The following lookup and resolve functions take <a href="../Cpath/Resolved/index.html">resolved paths</a> (for lookup) or <span class="xref-unresolved">unresolved paths</span> (for resolve) and an <a href="../Env/index.html#type-t">environment</a> and return the representation of the component. The resolve functions additionally return the resolved path. There are some common arguments:</p><ul><li><a href="../Env/index.html#type-t"><code>Env.t</code></a> is the environment that maps from <a href="../../Odoc_model/Paths/Identifier/index.html#type-t">Identifiers</a> to <a href="../Component/index.html">Components</a>.</li><li><code>mark_substituted</code> indicates that all paths in the resulting module that are the result of a substitution, either via a functor application or via a `with module..` construct, will be marked with a <code>`Substituted</code> constructor</li><li><code>add_canonical</code> asks for <code>`Canonical</code> constructors to be added to modules for which there is a defined canonical path. If the</li></ul><p>If the path is a 'Forward' path, that is, a path to a module that has not yet been compiled, then it may not be possible to resolve the path if this is being called during the 'compile' phase, in which case the function will return an unresolved path with no component. Resolution should be attempted again during the link phase.</p><p>On entry the assumption is that all <a href="../../Odoc_model/Paths/Identifier/index.html#type-t">Identifiers</a> in the paths are available in <code>env</code>, except where there are forward paths. If the environment does not contain all the required modules (for example, if odoc has not been called on all of the dependent modules), an unresolved path will be returned with no component.</p></aside><div><div class="spec value" id="val-lookup_module" class="anchored"><a href="#val-lookup_module" class="anchor"></a><code><span class="keyword">val</span> lookup_module : <span>mark_substituted:bool</span> <span>&#45;&gt;</span> <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-module_">Cpath.Resolved.module_</a> <span>&#45;&gt;</span> <span><span>(<span><a href="../Component/Module/index.html#type-t">Component.Module.t</a> <a href="../Component/Delayed/index.html#type-t">Component.Delayed.t</a></span>, <span>[ <a href="../Errors/index.html#type-simple_module_lookup_error">Errors.simple_module_lookup_error</a> <span>| <a href="../Errors/index.html#type-parent_lookup_error">Errors.parent_lookup_error</a></span> ]</span>)</span> <a href="../../../result/Result/index.html#type-result">Result.result</a></span></code></div><div><p><code>lookup_module ~mark_substituted env p</code> takes a resolved module cpath <code>p</code> and an environment and returns a representation of the module.</p></div></div><div><div class="spec value" id="val-lookup_module_type" class="anchored"><a href="#val-lookup_module_type" class="anchor"></a><code><span class="keyword">val</span> lookup_module_type : <span>mark_substituted:bool</span> <span>&#45;&gt;</span> <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-module_type">Cpath.Resolved.module_type</a> <span>&#45;&gt;</span> <span><span>(<a href="../Component/ModuleType/index.html#type-t">Component.ModuleType.t</a>, <span>[ <a href="../Errors/index.html#type-simple_module_type_lookup_error">Errors.simple_module_type_lookup_error</a> <span>| <a href="../Errors/index.html#type-parent_lookup_error">Errors.parent_lookup_error</a></span> ]</span>)</span> <a href="../../../result/Result/index.html#type-result">Result.result</a></span></code></div><div><p><code>lookup_module_type ~mark_substituted env p</code> takes a resolved module type cpath and an environment and returns a representation of the module type.</p></div></div><div><div class="spec value" id="val-lookup_type" class="anchored"><a href="#val-lookup_type" class="anchor"></a><code><span class="keyword">val</span> lookup_type : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-type_">Cpath.Resolved.type_</a> <span>&#45;&gt;</span> <span><span>(<span><span>(<a href="../Find/index.html#type-type_">Find.type_</a>, <a href="../Component/TypeExpr/index.html#type-t">Component.TypeExpr.t</a>)</span> <a href="../Find/index.html#type-found">Find.found</a></span>, <span>[ <a href="../Errors/index.html#type-simple_type_lookup_error">Errors.simple_type_lookup_error</a> <span>| <a href="../Errors/index.html#type-parent_lookup_error">Errors.parent_lookup_error</a></span> ]</span>)</span> <a href="../../../result/Result/index.html#type-result">Result.result</a></span></code></div><div><p><code>lookup_type env p</code> takes a resolved type path and an environment and returns a representation of the type. The type can be an ordinary type, a class type or a class. If the type has been destructively substituted, the path to the replacement type will be returned instead.</p></div></div><div><div class="spec value" id="val-lookup_class_type" class="anchored"><a href="#val-lookup_class_type" class="anchor"></a><code><span class="keyword">val</span> lookup_class_type : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-class_type">Cpath.Resolved.class_type</a> <span>&#45;&gt;</span> <span><span>(<span><span>(<a href="../Find/index.html#type-class_type">Find.class_type</a>, <a href="../Component/TypeExpr/index.html#type-t">Component.TypeExpr.t</a>)</span> <a href="../Find/index.html#type-found">Find.found</a></span>, <span>[ <a href="../Errors/index.html#type-simple_type_lookup_error">Errors.simple_type_lookup_error</a> <span>| <a href="../Errors/index.html#type-parent_lookup_error">Errors.parent_lookup_error</a></span> ]</span>)</span> <a href="../../../result/Result/index.html#type-result">Result.result</a></span></code></div><div><p><code>lookup_class_type env p</code> takes a resolved class type path and an environment and returns a representation of the class type. The type can be a class type or a class.</p></div></div><div><div class="spec value" id="val-resolve_module" class="anchored"><a href="#val-resolve_module" class="anchor"></a><code><span class="keyword">val</span> resolve_module : <span>mark_substituted:bool</span> <span>&#45;&gt;</span> <span>add_canonical:bool</span> <span>&#45;&gt;</span> <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/index.html#type-module_">Cpath.module_</a> <span>&#45;&gt;</span> <span><span>(<a href="../Cpath/Resolved/index.html#type-module_">Cpath.Resolved.module_</a> * <span><a href="../Component/Module/index.html#type-t">Component.Module.t</a> <a href="../Component/Delayed/index.html#type-t">Component.Delayed.t</a></span>, <a href="../Cpath/index.html#type-module_">Cpath.module_</a>)</span> <a href="ResolvedMonad/index.html#type-t">ResolvedMonad.t</a></span></code></div><div><p><code>resolve_module ~mark_substituted ~add_canonical env p</code> takes an unresolved module path and an environment and returns a tuple of the resolved module path alongside a representation of the module itself.</p></div></div><div><div class="spec value" id="val-resolve_module_type" class="anchored"><a href="#val-resolve_module_type" class="anchor"></a><code><span class="keyword">val</span> resolve_module_type : <span>mark_substituted:bool</span> <span>&#45;&gt;</span> <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/index.html#type-module_type">Cpath.module_type</a> <span>&#45;&gt;</span> <span><span>(<a href="../Cpath/Resolved/index.html#type-module_type">Cpath.Resolved.module_type</a> * <a href="../Component/ModuleType/index.html#type-t">Component.ModuleType.t</a>, <a href="../Cpath/index.html#type-module_type">Cpath.module_type</a>)</span> <a href="ResolvedMonad/index.html#type-t">ResolvedMonad.t</a></span></code></div><div><p><code>resolve_module_type ~mark_substituted env p</code> takes an unresolved module type path and an environment and returns a tuple of the resolved module type path alongside a representation of the module type itself.</p></div></div><div><div class="spec value" id="val-resolve_type" class="anchored"><a href="#val-resolve_type" class="anchor"></a><code><span class="keyword">val</span> resolve_type : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/index.html#type-type_">Cpath.type_</a> <span>&#45;&gt;</span> <span><span>(<a href="../Cpath/Resolved/index.html#type-type_">Cpath.Resolved.type_</a> * <span><span>(<a href="../Find/index.html#type-type_">Find.type_</a>, <a href="../Component/TypeExpr/index.html#type-t">Component.TypeExpr.t</a>)</span> <a href="../Find/index.html#type-found">Find.found</a></span>, <a href="../Cpath/index.html#type-type_">Cpath.type_</a>)</span> <a href="ResolvedMonad/index.html#type-t">ResolvedMonad.t</a></span></code></div><div><p><code>resolve_type env p</code> takes an unresolved type path and an environment and returns a tuple of the resolved type path alongside a representation of the type itself. As with <a href="index.html#val-lookup_type"><code>lookup_type</code></a> the returned type is either the type, class or class type, or if has been destructively substituted the return value is the path to the replaced type, class or class type.</p></div></div><div><div class="spec value" id="val-resolve_class_type" class="anchored"><a href="#val-resolve_class_type" class="anchor"></a><code><span class="keyword">val</span> resolve_class_type : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/index.html#type-class_type">Cpath.class_type</a> <span>&#45;&gt;</span> <span><span>(<a href="../Cpath/Resolved/index.html#type-class_type">Cpath.Resolved.class_type</a> * <span><span>(<a href="../Find/index.html#type-class_type">Find.class_type</a>, <a href="../Component/TypeExpr/index.html#type-t">Component.TypeExpr.t</a>)</span> <a href="../Find/index.html#type-found">Find.found</a></span>, <a href="../Cpath/index.html#type-class_type">Cpath.class_type</a>)</span> <a href="ResolvedMonad/index.html#type-t">ResolvedMonad.t</a></span></code></div><div><p><code>resolve_class_type env p</code> takes an unresolved class type path and an environment and returns a tuple of the resolved class type path alongside a representation of the class type itself. As with <a href="index.html#val-lookup_type"><code>lookup_type</code></a> the returned type is either the class or class type.</p></div></div><h4 id="convenience-functions"><a href="#convenience-functions" class="anchor"></a>Convenience functions</h4><aside><p>The following functions are convenience functions called from <a href="../Compile/index.html"><code>Compile</code></a> or <a href="../Link/index.html"><code>Link</code></a>, and simply call the <code>resolve_*</code> functions above and ignore the component. For the cases of modules and module types, these functions will additionally prepend an <code>OpaqueModule</code> or <code>OpaqueModuleType</code> constructor to the path if the module or module type cannot be expanded</p></aside><div class="spec value" id="val-resolve_module_path" class="anchored"><a href="#val-resolve_module_path" class="anchor"></a><code><span class="keyword">val</span> resolve_module_path : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/index.html#type-module_">Cpath.module_</a> <span>&#45;&gt;</span> <span><span>(<a href="../Cpath/Resolved/index.html#type-module_">Cpath.Resolved.module_</a>, <a href="../Cpath/index.html#type-module_">Cpath.module_</a>)</span> <a href="ResolvedMonad/index.html#type-t">ResolvedMonad.t</a></span></code></div><div class="spec value" id="val-resolve_module_type_path" class="anchored"><a href="#val-resolve_module_type_path" class="anchor"></a><code><span class="keyword">val</span> resolve_module_type_path : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/index.html#type-module_type">Cpath.module_type</a> <span>&#45;&gt;</span> <span><span>(<a href="../Cpath/Resolved/index.html#type-module_type">Cpath.Resolved.module_type</a>, <a href="../Cpath/index.html#type-module_type">Cpath.module_type</a>)</span> <a href="ResolvedMonad/index.html#type-t">ResolvedMonad.t</a></span></code></div><div class="spec value" id="val-resolve_type_path" class="anchored"><a href="#val-resolve_type_path" class="anchor"></a><code><span class="keyword">val</span> resolve_type_path : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/index.html#type-type_">Cpath.type_</a> <span>&#45;&gt;</span> <span><span>(<a href="../Cpath/Resolved/index.html#type-type_">Cpath.Resolved.type_</a>, <a href="../Cpath/index.html#type-type_">Cpath.type_</a>)</span> <a href="ResolvedMonad/index.html#type-t">ResolvedMonad.t</a></span></code></div><div class="spec value" id="val-resolve_class_type_path" class="anchored"><a href="#val-resolve_class_type_path" class="anchor"></a><code><span class="keyword">val</span> resolve_class_type_path : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/index.html#type-class_type">Cpath.class_type</a> <span>&#45;&gt;</span> <span><span>(<a href="../Cpath/Resolved/index.html#type-class_type">Cpath.Resolved.class_type</a>, <a href="../Cpath/index.html#type-class_type">Cpath.class_type</a>)</span> <a href="ResolvedMonad/index.html#type-t">ResolvedMonad.t</a></span></code></div><h3 id="re-resolve-functions"><a href="#re-resolve-functions" class="anchor"></a>Re-resolve functions</h3><aside><p>The re-resolve functions are called during the link phase to resolve canonical paths. They take as input only resolved paths. If any path remains unresolved as link phase, the path should be resolved via a call to <a href="index.html#val-resolve_module"><code>resolve_module</code></a> or similar, and then passed to <a href="index.html#val-reresolve_module"><code>reresolve_module</code></a></p></aside><div class="spec value" id="val-reresolve_module" class="anchored"><a href="#val-reresolve_module" class="anchor"></a><code><span class="keyword">val</span> reresolve_module : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-module_">Cpath.Resolved.module_</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-module_">Cpath.Resolved.module_</a></code></div><div class="spec value" id="val-reresolve_module_type" class="anchored"><a href="#val-reresolve_module_type" class="anchor"></a><code><span class="keyword">val</span> reresolve_module_type : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-module_type">Cpath.Resolved.module_type</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-module_type">Cpath.Resolved.module_type</a></code></div><div class="spec value" id="val-reresolve_type" class="anchored"><a href="#val-reresolve_type" class="anchor"></a><code><span class="keyword">val</span> reresolve_type : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-type_">Cpath.Resolved.type_</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-type_">Cpath.Resolved.type_</a></code></div><h3 id="ref_tools-helpers"><a href="#ref_tools-helpers" class="anchor"></a>Ref_tools helpers</h3><aside><p>The following functions are exposed for use in the <a href="../Ref_tools/index.html"><code>Ref_tools</code></a> module only, allowing that module to reuse the machinery in this module for the resolution of <a href="../../Odoc_model/Paths/Reference/index.html">References</a></p></aside><div class="spec value" id="val-reresolve_parent" class="anchored"><a href="#val-reresolve_parent" class="anchor"></a><code><span class="keyword">val</span> reresolve_parent : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-parent">Cpath.Resolved.parent</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-parent">Cpath.Resolved.parent</a></code></div><div class="spec value" id="val-handle_module_type_lookup" class="anchored"><a href="#val-handle_module_type_lookup" class="anchor"></a><code><span class="keyword">val</span> handle_module_type_lookup : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../../Odoc_model/Names/ModuleTypeName/index.html#type-t">Odoc_model.Names.ModuleTypeName.t</a> <span>&#45;&gt;</span> <a href="../Cpath/Resolved/index.html#type-parent">Cpath.Resolved.parent</a> <span>&#45;&gt;</span> <a href="../Component/Signature/index.html#type-t">Component.Signature.t</a> <span>&#45;&gt;</span> <a href="../Component/Substitution/index.html#type-t">Component.Substitution.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Cpath/Resolved/index.html#type-module_type">Cpath.Resolved.module_type</a> * <a href="../Component/ModuleType/index.html#type-t">Component.ModuleType.t</a>)</span> option</span></code></div><div class="spec type" id="type-module_modifiers" class="anchored"><a href="#type-module_modifiers" class="anchor"></a><code><span class="keyword">type</span> module_modifiers = [ </code><table><tr id="type-module_modifiers.Aliased" class="anchored"><td class="def constructor"><a href="#type-module_modifiers.Aliased" class="anchor"></a><code>| </code><code>`Aliased <span class="keyword">of</span> <a href="../Cpath/Resolved/index.html#type-module_">Cpath.Resolved.module_</a></code></td></tr><tr id="type-module_modifiers.SubstAliased" class="anchored"><td class="def constructor"><a href="#type-module_modifiers.SubstAliased" class="anchor"></a><code>| </code><code>`SubstAliased <span class="keyword">of</span> <a href="../Cpath/Resolved/index.html#type-module_">Cpath.Resolved.module_</a></code></td></tr><tr id="type-module_modifiers.SubstMT" class="anchored"><td class="def constructor"><a href="#type-module_modifiers.SubstMT" class="anchor"></a><code>| </code><code>`SubstMT <span class="keyword">of</span> <a href="../Cpath/Resolved/index.html#type-module_type">Cpath.Resolved.module_type</a></code></td></tr></table><code> ]</code></div><div class="spec value" id="val-get_module_path_modifiers" class="anchored"><a href="#val-get_module_path_modifiers" class="anchor"></a><code><span class="keyword">val</span> get_module_path_modifiers : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <span>add_canonical:bool</span> <span>&#45;&gt;</span> <a href="../Component/Module/index.html#type-t">Component.Module.t</a> <span>&#45;&gt;</span> <span><a href="index.html#type-module_modifiers">module_modifiers</a> option</span></code></div><div class="spec value" id="val-prefix_signature" class="anchored"><a href="#val-prefix_signature" class="anchor"></a><code><span class="keyword">val</span> prefix_signature : <span>(<a href="../Cpath/Resolved/index.html#type-parent">Cpath.Resolved.parent</a> * <a href="../Component/Signature/index.html#type-t">Component.Signature.t</a>)</span> <span>&#45;&gt;</span> <a href="../Component/Signature/index.html#type-t">Component.Signature.t</a></code></div><div class="spec value" id="val-signature_of_module" class="anchored"><a href="#val-signature_of_module" class="anchor"></a><code><span class="keyword">val</span> signature_of_module : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Component/Module/index.html#type-t">Component.Module.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Component/Signature/index.html#type-t">Component.Signature.t</a>, <a href="../Errors/index.html#type-signature_of_module_error">Errors.signature_of_module_error</a>)</span> <a href="../../../result/Result/index.html#type-result">Result.result</a></span></code></div><div class="spec value" id="val-signature_of_module_type" class="anchored"><a href="#val-signature_of_module_type" class="anchor"></a><code><span class="keyword">val</span> signature_of_module_type : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Component/ModuleType/index.html#type-t">Component.ModuleType.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Component/Signature/index.html#type-t">Component.Signature.t</a>, <a href="../Errors/index.html#type-signature_of_module_error">Errors.signature_of_module_error</a>)</span> <a href="../../../result/Result/index.html#type-result">Result.result</a></span></code></div><div class="spec value" id="val-class_signature_of_class_type" class="anchored"><a href="#val-class_signature_of_class_type" class="anchor"></a><code><span class="keyword">val</span> class_signature_of_class_type : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Component/ClassType/index.html#type-t">Component.ClassType.t</a> <span>&#45;&gt;</span> <span><a href="../Component/ClassSignature/index.html#type-t">Component.ClassSignature.t</a> option</span></code></div><div class="spec value" id="val-class_signature_of_class" class="anchored"><a href="#val-class_signature_of_class" class="anchor"></a><code><span class="keyword">val</span> class_signature_of_class : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Component/Class/index.html#type-t">Component.Class.t</a> <span>&#45;&gt;</span> <span><a href="../Component/ClassSignature/index.html#type-t">Component.ClassSignature.t</a> option</span></code></div><h3 id="fragment-resolution"><a href="#fragment-resolution" class="anchor"></a>Fragment resolution</h3><div><div class="spec value" id="val-signature_of_module_type_expr" class="anchored"><a href="#val-signature_of_module_type_expr" class="anchor"></a><code><span class="keyword">val</span> signature_of_module_type_expr : <span>mark_substituted:bool</span> <span>&#45;&gt;</span> <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Component/ModuleType/index.html#type-expr">Component.ModuleType.expr</a> <span>&#45;&gt;</span> <span><span>(<a href="../Component/Signature/index.html#type-t">Component.Signature.t</a>, <a href="../Errors/index.html#type-signature_of_module_error">Errors.signature_of_module_error</a>)</span> <a href="../../../result/Result/index.html#type-result">Result.result</a></span></code></div><div><p>The following functions are use for the resolution of <a href="../../Odoc_model/Paths/Fragment/index.html#type-t">Fragments</a> Whilst resolving fragments it is necessary to process them in order, applying the 'with' expression of module or type equality or substitution, before resolving the next fragment. The function <code>signature_of_module_type_expr</code> is used to supply the signature for the first fragment. For this purpose, <code>mark_substituted</code> should be <code>true</code>. As for the path resolution functions above, the resolve functions may be called during compile or link, whereas the reresolve functions should only be called during the link phase.</p></div></div><div class="spec value" id="val-resolve_module_fragment" class="anchored"><a href="#val-resolve_module_fragment" class="anchor"></a><code><span class="keyword">val</span> resolve_module_fragment : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <span>(<a href="../Cfrag/index.html#type-root">Cfrag.root</a> * <a href="../Component/Signature/index.html#type-t">Component.Signature.t</a>)</span> <span>&#45;&gt;</span> <a href="../Cfrag/index.html#type-module_">Cfrag.module_</a> <span>&#45;&gt;</span> <span><a href="../Cfrag/index.html#type-resolved_module">Cfrag.resolved_module</a> option</span></code></div><div class="spec value" id="val-resolve_type_fragment" class="anchored"><a href="#val-resolve_type_fragment" class="anchor"></a><code><span class="keyword">val</span> resolve_type_fragment : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <span>(<a href="../Cfrag/index.html#type-root">Cfrag.root</a> * <a href="../Component/Signature/index.html#type-t">Component.Signature.t</a>)</span> <span>&#45;&gt;</span> <a href="../Cfrag/index.html#type-type_">Cfrag.type_</a> <span>&#45;&gt;</span> <span><a href="../Cfrag/index.html#type-resolved_type">Cfrag.resolved_type</a> option</span></code></div><div class="spec value" id="val-reresolve_module_fragment" class="anchored"><a href="#val-reresolve_module_fragment" class="anchor"></a><code><span class="keyword">val</span> reresolve_module_fragment : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cfrag/index.html#type-resolved_module">Cfrag.resolved_module</a> <span>&#45;&gt;</span> <a href="../Cfrag/index.html#type-resolved_module">Cfrag.resolved_module</a></code></div><div class="spec value" id="val-reresolve_type_fragment" class="anchored"><a href="#val-reresolve_type_fragment" class="anchor"></a><code><span class="keyword">val</span> reresolve_type_fragment : <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Cfrag/index.html#type-resolved_type">Cfrag.resolved_type</a> <span>&#45;&gt;</span> <a href="../Cfrag/index.html#type-resolved_type">Cfrag.resolved_type</a></code></div><h3 id="fragmap-functions"><a href="#fragmap-functions" class="anchor"></a>Fragmap functions</h3><aside><p>The following functions take a signature and apply a transformation to it corresponding to one item in a <code>with type|module</code> module type. The functions construct a representation that is self-contained, meaning correct even without having to remember that it is the result of a fragment modification. For example:</p><pre><code>module type S = sig
    type t
end
module type T = sig
  module M : S
end
module type Z = T with type M.t = int</code></pre><p>these functions should return a representation of <code>Z</code> as:</p><pre><code>module type T = sig
    module M : S with type t = int
end</code></pre><p>In particular, it will also handle <code>include</code> statements such that if a type or module introduced by an <code>include</code> is the subject of a fragment modification, the <code>include</code> statement will be marked as having a fragment modifier applied.</p></aside><div><div class="spec value" id="val-fragmap" class="anchored"><a href="#val-fragmap" class="anchor"></a><code><span class="keyword">val</span> fragmap : <span>mark_substituted:bool</span> <span>&#45;&gt;</span> <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Component/ModuleType/index.html#type-substitution">Component.ModuleType.substitution</a> <span>&#45;&gt;</span> <a href="../Component/Signature/index.html#type-t">Component.Signature.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Component/Signature/index.html#type-t">Component.Signature.t</a>, <a href="../Errors/index.html#type-signature_of_module_error">Errors.signature_of_module_error</a>)</span> <a href="../../../result/Result/index.html#type-result">Result.result</a></span></code></div><div><p><code>fragmap ~mark_substituted env sub sg</code> takes an environment <code>env</code> and signature <code>sg</code>, and a fragment substitution (e.g. <code>ModuleSubst</code> to destructively substitute a module), and returns the substituted signature.</p></div></div><div><div class="spec value" id="val-handle_signature_with_subs" class="anchored"><a href="#val-handle_signature_with_subs" class="anchor"></a><code><span class="keyword">val</span> handle_signature_with_subs : <span>mark_substituted:bool</span> <span>&#45;&gt;</span> <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <a href="../Component/Signature/index.html#type-t">Component.Signature.t</a> <span>&#45;&gt;</span> <span><a href="../Component/ModuleType/index.html#type-substitution">Component.ModuleType.substitution</a> list</span> <span>&#45;&gt;</span> <span><span>(<a href="../Component/Signature/index.html#type-t">Component.Signature.t</a>, <a href="../Errors/index.html#type-signature_of_module_error">Errors.signature_of_module_error</a>)</span> <a href="../../../result/Result/index.html#type-result">Result.result</a></span></code></div><div><p><code>handle_signature_with_subs ~mark_substituted env sg subs</code> applies the fragment modifiers <code>subs</code>, in order, to the supplied signature <code>sg</code>.</p></div></div><h3 id="cache-handling"><a href="#cache-handling" class="anchor"></a>Cache handling</h3><aside><p>In order to resolve paths quickly, several imperative caches are used. The following functions are used to manipulate the caches</p></aside><div><div class="spec value" id="val-reset_caches" class="anchored"><a href="#val-reset_caches" class="anchor"></a><code><span class="keyword">val</span> reset_caches : unit <span>&#45;&gt;</span> unit</code></div><div><p>Empty the caches completely</p></div></div><div><div class="spec value" id="val-disable_all_caches" class="anchored"><a href="#val-disable_all_caches" class="anchor"></a><code><span class="keyword">val</span> disable_all_caches : unit <span>&#45;&gt;</span> unit</code></div><div><p>Disable the caches completely</p></div></div><div class="spec module" id="module-Fmt" class="anchored"><a href="#module-Fmt" class="anchor"></a><code><span class="keyword">module</span> <a href="Fmt/index.html">Fmt</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></div></body></html>